(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ae942b12"],{2691:function(e,t,a){"use strict";a("b9e9")},"5d8c":function(e,t,a){e.exports=a.p+"static/img/10.a0ba115f.png"},b9e9:function(e,t,a){},ffb0:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"main"},[a("div",{staticClass:"operation"},[a("div",{staticClass:"button-wrap"},[a("el-input",{attrs:{type:"color"},model:{value:e.colorValue,callback:function(t){e.colorValue=t},expression:"colorValue"}},[e._v("颜色")]),a("el-button",{attrs:{type:"text"},on:{click:e.addImg}},[e._v("上传")]),a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.exportImg()}}},[e._v("导出")]),a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.setMode("PAN")}}},[e._v("平移")]),a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.setMode("LINE")}}},[e._v("线段")]),a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.setMode("POLYLINE")}}},[e._v("多段线")]),a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.setMode("CIRCLE")}}},[e._v("圆")]),a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.setMode("RECT")}}},[e._v("矩形")]),a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.setMode("POLYGON")}}},[e._v("多边形")]),a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.Fill()}}},[e._v("填充")]),a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.Revoke()}}},[e._v("撤销")]),a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.getFeatures()}}},[e._v("获取标注数据")])],1),a("div",{staticClass:"zoom-icon-wrapper"},[a("div",{staticClass:"zoom-icon-plus",on:{click:e.zoomIn}},[e._v("+")]),a("div",{staticClass:"zoom-icon-minus",on:{click:e.zoomOut}},[e._v("-")])])]),a("div",{key:e.mapKey,attrs:{id:"map"}}),a("p",{staticClass:"helpText"},[e._v("目前只支持PC暂未做移动端适配...")]),a("input",{ref:"uploadImg",staticStyle:{display:"none"},attrs:{type:"file",accept:".png, .jpg, .jpeg"},on:{change:e.addFile}})])},r=[],i=a("75d9"),o=a("61c6"),s=a("f505"),l=a("bebf"),c=(a("933e"),a("5532"),a("a153"),a("7ce3"),a("6944"),a("20fe"),a("1ff5"),a("a951"),a("9eab"),a("b96a")),u=a.n(c),d={name:"HelloWorld",data:function(){return{mapKey:0,imgUrl:a("5d8c"),drawingStyle:{},mode:"",itemName:"",editId:"",deleteIconId:"delete01",gMap:null,gFirstFeatureLayer:null,allFeatures:null,colorValue:null}},watch:{colorValue:function(){this.setDrawingStyle(this.mode)},mode:function(e){this.gMap.setMode(e),this.setDrawingStyle(e)}},methods:{addFile:function(){var e=this,t=this.$refs.uploadImg,a=t.files;if(console.log(a[0]),a[0]){var n=new FileReader;n.addEventListener("load",(function(){console.log(this.result),e.imgUrl=this.result,e.initMap()})),n.readAsDataURL(a[0])}},addImg:function(){this.$refs.uploadImg.value="",this.$refs.uploadImg.click()},exportImg:function(){var e=this;return Object(l["a"])(Object(s["a"])().mark((function t(){var a,n;return Object(s["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.gMap.exportLayersToImage({x:0,y:0,width:500,height:354},{type:"blob",format:"image/png"});case 2:a=t.sent,n=document.createElement("a"),n.download="img.png",n.style.display="none",n.href=URL.createObjectURL(a),document.body.appendChild(n),n.click(),URL.revokeObjectURL(n.href),document.body.removeChild(n);case 11:case"end":return t.stop()}}),t)})))()},zoomIn:function(){this.gMap.zoomIn()},zoomOut:function(){this.gMap.zoomOut()},setMode:function(e){this.mode=e},getFeatures:function(){this.allFeatures=this.gFirstFeatureLayer.getAllFeatures(),console.log("--allFeatures--",this.allFeatures)},setDrawingStyle:function(e){var t={};switch(e){case"PAN":break;case"MARKER":break;case"POINT":this.drawingStyle={fillStyle:this.colorValue},this.gMap.setDrawingStyle(t);break;case"CIRCLE":this.drawingStyle={fillStyle:this.colorValue,strokeStyle:this.colorValue,lineWidth:5},this.gMap.setDrawingStyle(t);break;case"LINE":this.drawingStyle={strokeStyle:this.colorValue,lineJoin:"round",lineCap:"round",lineWidth:10,arrow:!1},this.gMap.setDrawingStyle(t);break;case"POLYLINE":this.drawingStyle={strokeStyle:this.colorValue,lineJoin:"round",lineCap:"round",lineWidth:10},this.gMap.setDrawingStyle(t);break;case"RECT":this.drawingStyle={strokeStyle:this.colorValue,lineWidth:1},this.gMap.setDrawingStyle(t);break;case"POLYGON":var a;this.drawingStyle=(a={strokeStyle:this.colorValue,fill:!0,fillStyle:"#FF6666",globalAlpha:.3,lineWidth:3},Object(o["a"])(a,"fill",!0),Object(o["a"])(a,"stroke",!0),a),this.gMap.setDrawingStyle(t);break;case"DRAWMASK":this.drawingStyle={strokeStyle:this.colorValue,fillStyle:"#00f",lineWidth:50},this.gMap.setDrawingStyle(t);break;case"CLEARMASK":this.drawingStyle={fillStyle:"#00f",lineWidth:30},this.gMap.setDrawingStyle(t);break;default:break}},addFeature:function(e,t,a){var n=this,r=this.drawingStyle;if("LINE"===t){var o=n.gMap.getScale(),s=r.lineWidth/o,l=new u.a.Feature.Line(a,Object(i["a"])(Object(i["a"])({},e),{},{width:s}),{name:name},r);n.gFirstFeatureLayer.addFeature(l)}else if("POLYLINE"===t){var c=n.gMap.getScale(),d=r.lineWidth/c,h=new u.a.Feature.Polyline(a,{points:e,width:d},{name:name},r);n.gFirstFeatureLayer.addFeature(h)}else if("RECT"===t){var p=new u.a.Feature.Rect(a,e,{name:name},r);n.gFirstFeatureLayer.addFeature(p)}else if("POLYGON"===t){var g=new u.a.Feature.Polygon(a,{points:e},{name:name},r);n.gFirstFeatureLayer.addFeature(g)}else if("POINT"==t){var f=new u.a.Feature.Point(a,{x:e.x,y:e.y,r:5},{name:name},r);n.gFirstFeatureLayer.addFeature(f)}else if("MARKER"==t){var y=new u.a.Marker(a,{src:"http://ailabel.com.cn/public/ailabel/demo/marker.png",position:{x:e.x,y:e.y},offset:{x:-16,y:32}},{name:"第一个marker注记"});n.gFirstFeatureLayer.addFeature(y)}else if("CIRCLE"==t){var m=new u.a.Feature.Circle(a,{cx:e.cx,cy:e.cy,r:e.r},{name:"第一个矢量图层"},r);n.gFirstFeatureLayer.addFeature(m)}else if("DRAWMASK"==t){var v=new u.a.Mask.Draw("".concat(+new Date),"铅笔",{points:e,width:5},{name:"港币",price:"1元"},r);n.gFirstFeatureLayer.addAction(v)}else if("CLEARMASK"==t){var F=new u.a.Mask.Clear("first-action-clear",{points:e,width:5},r);n.gFirstMaskLayer.addAction(F)}this.getFeatures()},getName:function(e){var t=this;return this.$prompt("请输入填写名字",{confirmButtonText:"确定",showCancelButton:!1}).then((function(e){var a=e.value;return t.itemName=a,a})).catch((function(){return null}))},addDeleteIcon:function(e,t){var a=this.gMap,n=this;console.log(t,"shape");var r=new u.a.Marker(n.deleteIconId,{src:"http://10.10.15.107:9529/static/img/10.a0ba115f.png",position:{x:t.x+t.width,y:t.y-15},offset:{x:-20,y:-4}},{name:"delete"});r.events.on("click",(function(t){a.markerLayer.removeMarkerById(t.id),n.gFirstFeatureLayer.removeFeatureById(e.id)})),a.markerLayer.addMarker(r)},deIcon:function(){this.gMap.markerLayer.removeAllMarkers()},addEvent:function(){var e=this,t=this,a=this.gMap;a.events.on("drawDone",(function(e,a){console.log("--type, data--",e,a),t.addFeature(a,e)})),a.events.on("boundsChanged",(function(e){return console.log("--map boundsChanged--",e),""})),a.events.on("featureSelected",(function(n){e.editId=n.id,console.log("--map featureSelected--",n,"双击编辑"),a.setActiveFeature(n),"POINT"!=n.type&&t.addDeleteIcon(n,n.shape)})),a.events.on("featureDeleted",(function(e){"POINT"==e.type&&t.gFirstFeatureLayer.removeFeatureById(e.id)})),a.events.on("featureUnselected",(function(){t.editId="",t.deIcon(),a.setActiveFeature(null)})),a.events.on("featureUpdated",(function(e,a){console.log(e),t.deIcon(),e.updateShape(a),"POINT"!=e.type&&t.addDeleteIcon(e,a)})),a.events.on("FeatureDeleted",(function(){console.log(2222222)}))},getPoints:function(e){switch(e.type){case"RECT":return e.getPoints();case"LINE":return[e.shape.start,e.shape.end];case"POLYLINE":return e.shape.points;case"POLYGON":return e.shape.points;default:return[]}},Fill:function(){console.log("填充事件");var e=this.gFirstFeatureLayer.getFeatureById(this.editId);e?(console.log("--填充对象--",e),e.style.fillStyle=this.colorValue,e.style.fill=!0,this.gMap.refresh()):this.$message.error("请选中后再填充")},Revoke:function(){console.log("撤销"),this.getFeatures(),this.allFeatures.pop(),this.gMap.refresh(),console.log(this.allFeatures,"--所有操作--")},initMap:function(){var e=this;this.mapKey++;var t=this;this.$nextTick((function(){var a=new u.a.Map("map",{center:{x:250,y:150},zoom:500,mode:"PAN",refreshDelayWhenZooming:!0,zoomWhenDrawing:!0,panWhenDrawing:!0,zoomWheelRatio:5,withHotKeys:!0});t.gMap=a,e.addEvent();var n=new u.a.Layer.Image("first-layer-image",{src:t.imgUrl,width:500,height:300,crossOrigin:!1,position:{x:0,y:0}},{name:"第一个图片图层"},{zIndex:5});a.addLayer(n);var r=new u.a.Layer.Feature("first-layer-feature",{name:"第一个矢量图层"},{zIndex:10});e.gFirstFeatureLayer=r,a.addLayer(r),window.onresize=function(){this.gMap&&this.gMap.resize()}}))}},mounted:function(){this.initMap()},beforeDestroy:function(){this.gMap.destroy()}},h=d,p=(a("2691"),a("e607")),g=Object(p["a"])(h,n,r,!1,null,null,null);t["default"]=g.exports}}]);