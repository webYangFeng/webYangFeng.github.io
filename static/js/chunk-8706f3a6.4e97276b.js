(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-8706f3a6"],{"26a1":function(e,t,r){(function(t){(function(t,r){e.exports=r()})(0,(function(){"use strict";function e(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(l){return void r(l)}s.done?t(u):Promise.resolve(u).then(n,i)}function r(t){return function(){var r=this,n=arguments;return new Promise((function(i,o){var a=t.apply(r,n);function s(t){e(a,i,o,s,u,"next",t)}function u(t){e(a,i,o,s,u,"throw",t)}s(void 0)}))}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var s="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof t?t:"undefined"!==typeof self?self:{},u={exports:{}};(function(e){var t=function(e){var t,r=Object.prototype,n=r.hasOwnProperty,i="function"===typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(L){u=function(e,t,r){return e[t]=r}}function l(e,t,r,n){var i=t&&t.prototype instanceof d?t:d,o=Object.create(i.prototype),a=new A(n||[]);return o._invoke=S(e,r,a),o}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(L){return{type:"throw",arg:L}}}e.wrap=l;var h="suspendedStart",f="suspendedYield",v="executing",y="completed",p={};function d(){}function m(){}function g(){}var b={};u(b,o,(function(){return this}));var w=Object.getPrototypeOf,x=w&&w(w(M([])));x&&x!==r&&n.call(x,o)&&(b=x);var k=g.prototype=d.prototype=Object.create(b);function O(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function P(e,t){function r(i,o,a,s){var u=c(e[i],e,o);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"===typeof h&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(h).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(u.arg)}var i;function o(e,n){function o(){return new t((function(t,i){r(e,n,t,i)}))}return i=i?i.then(o,o):o()}this._invoke=o}function S(e,t,r){var n=h;return function(i,o){if(n===v)throw new Error("Generator is already running");if(n===y){if("throw"===i)throw o;return T()}r.method=i,r.arg=o;while(1){var a=r.delegate;if(a){var s=D(a,r);if(s){if(s===p)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===h)throw n=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=v;var u=c(e,t,r);if("normal"===u.type){if(n=r.done?y:f,u.arg===p)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n=y,r.method="throw",r.arg=u.arg)}}}function D(e,r){var n=e.iterator[r.method];if(n===t){if(r.delegate=null,"throw"===r.method){if(e.iterator["return"]&&(r.method="return",r.arg=t,D(e,r),"throw"===r.method))return p;r.method="throw",r.arg=new TypeError("The iterator does not provide a 'throw' method")}return p}var i=c(n,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,p;var o=i.arg;return o?o.done?(r[e.resultName]=o.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,p):o:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,p)}function j(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function C(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function A(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(j,this),this.reset(!0)}function M(e){if(e){var r=e[o];if(r)return r.call(e);if("function"===typeof e.next)return e;if(!isNaN(e.length)){var i=-1,a=function r(){while(++i<e.length)if(n.call(e,i))return r.value=e[i],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}return{next:T}}function T(){return{value:t,done:!0}}return m.prototype=g,u(k,"constructor",g),u(g,"constructor",m),m.displayName=u(g,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"===typeof e&&e.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,u(e,s,"GeneratorFunction")),e.prototype=Object.create(k),e},e.awrap=function(e){return{__await:e}},O(P.prototype),u(P.prototype,a,(function(){return this})),e.AsyncIterator=P,e.async=function(t,r,n,i,o){void 0===o&&(o=Promise);var a=new P(l(t,r,n,i),o);return e.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},O(k),u(k,s,"Generator"),u(k,o,(function(){return this})),u(k,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){while(t.length){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},e.values=M,A.prototype={constructor:A,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(C),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0],t=e.completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function i(n,i){return s.type="throw",s.arg=e,r.next=n,i&&(r.method="next",r.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,p):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),C(r),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;C(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:M(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),p}},e}(e.exports);try{regeneratorRuntime=t}catch(r){"object"===typeof globalThis?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}})(u);var l,c=u.exports,h={exports:{}},f="object"===typeof Reflect?Reflect:null,v=f&&"function"===typeof f.apply?f.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};function y(e){console&&console.warn&&console.warn(e)}l=f&&"function"===typeof f.ownKeys?f.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var p=Number.isNaN||function(e){return e!==e};function d(){d.init.call(this)}h.exports=d,h.exports.once=C,d.EventEmitter=d,d.prototype._events=void 0,d.prototype._eventsCount=0,d.prototype._maxListeners=void 0;var m=10;function g(e){if("function"!==typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function b(e){return void 0===e._maxListeners?d.defaultMaxListeners:e._maxListeners}function w(e,t,r,n){var i,o,a;if(g(r),o=e._events,void 0===o?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),o=e._events),a=o[t]),void 0===a)a=o[t]=r,++e._eventsCount;else if("function"===typeof a?a=o[t]=n?[r,a]:[a,r]:n?a.unshift(r):a.push(r),i=b(e),i>0&&a.length>i&&!a.warned){a.warned=!0;var s=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");s.name="MaxListenersExceededWarning",s.emitter=e,s.type=t,s.count=a.length,y(s)}return e}function x(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function k(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},i=x.bind(n);return i.listener=r,n.wrapFn=i,i}function O(e,t,r){var n=e._events;if(void 0===n)return[];var i=n[t];return void 0===i?[]:"function"===typeof i?r?[i.listener||i]:[i]:r?j(i):S(i,i.length)}function P(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"===typeof r)return 1;if(void 0!==r)return r.length}return 0}function S(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}function D(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}function j(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}function C(e,t){return new Promise((function(r,n){function i(r){e.removeListener(t,o),n(r)}function o(){"function"===typeof e.removeListener&&e.removeListener("error",i),r([].slice.call(arguments))}M(e,t,o,{once:!0}),"error"!==t&&A(e,i,{once:!0})}))}function A(e,t,r){"function"===typeof e.on&&M(e,"error",t,r)}function M(e,t,r,n){if("function"===typeof e.on)n.once?e.once(t,r):e.on(t,r);else{if("function"!==typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function i(o){n.once&&e.removeEventListener(t,i),r(o)}))}}Object.defineProperty(d,"defaultMaxListeners",{enumerable:!0,get:function(){return m},set:function(e){if("number"!==typeof e||e<0||p(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");m=e}}),d.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},d.prototype.setMaxListeners=function(e){if("number"!==typeof e||e<0||p(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},d.prototype.getMaxListeners=function(){return b(this)},d.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var n="error"===e,i=this._events;if(void 0!==i)n=n&&void 0===i.error;else if(!n)return!1;if(n){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var s=i[e];if(void 0===s)return!1;if("function"===typeof s)v(s,this,t);else{var u=s.length,l=S(s,u);for(r=0;r<u;++r)v(l[r],this,t)}return!0},d.prototype.addListener=function(e,t){return w(this,e,t,!1)},d.prototype.on=d.prototype.addListener,d.prototype.prependListener=function(e,t){return w(this,e,t,!0)},d.prototype.once=function(e,t){return g(t),this.on(e,k(this,e,t)),this},d.prototype.prependOnceListener=function(e,t){return g(t),this.prependListener(e,k(this,e,t)),this},d.prototype.removeListener=function(e,t){var r,n,i,o,a;if(g(t),n=this._events,void 0===n)return this;if(r=n[e],void 0===r)return this;if(r===t||r.listener===t)0===--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!==typeof r){for(i=-1,o=r.length-1;o>=0;o--)if(r[o]===t||r[o].listener===t){a=r[o].listener,i=o;break}if(i<0)return this;0===i?r.shift():D(r,i),1===r.length&&(n[e]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",e,a||t)}return this},d.prototype.off=d.prototype.removeListener,d.prototype.removeAllListeners=function(e){var t,r,n;if(r=this._events,void 0===r)return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0===--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0===arguments.length){var i,o=Object.keys(r);for(n=0;n<o.length;++n)i=o[n],"removeListener"!==i&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=r[e],"function"===typeof t)this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},d.prototype.listeners=function(e){return O(this,e,!0)},d.prototype.rawListeners=function(e){return O(this,e,!1)},d.listenerCount=function(e,t){return"function"===typeof e.listenerCount?e.listenerCount(t):P.call(e,t)},d.prototype.listenerCount=P,d.prototype.eventNames=function(){return this._eventsCount>0?l(this._events):[]};var T=h.exports,L="undefined"!==typeof navigator&&navigator.userAgent.toLowerCase().indexOf("firefox")>0;
/*!
   * hotkeys-js v3.8.7
   * A simple micro-library for defining and dispatching keyboard shortcuts. It has no dependencies.
   * 
   * Copyright (c) 2021 kenny wong <wowohoo@qq.com>
   * http://jaywcjlove.github.io/hotkeys
   * 
   * Licensed under the MIT license.
   */function E(e,t,r){e.addEventListener?e.addEventListener(t,r,!1):e.attachEvent&&e.attachEvent("on".concat(t),(function(){r(window.event)}))}function R(e,t){for(var r=t.slice(0,t.length-1),n=0;n<r.length;n++)r[n]=e[r[n].toLowerCase()];return r}function I(e){"string"!==typeof e&&(e=""),e=e.replace(/\s/g,"");for(var t=e.split(","),r=t.lastIndexOf("");r>=0;)t[r-1]+=",",t.splice(r,1),r=t.lastIndexOf("");return t}function F(e,t){for(var r=e.length>=t.length?e:t,n=e.length>=t.length?t:e,i=!0,o=0;o<r.length;o++)-1===n.indexOf(r[o])&&(i=!1);return i}for(var _={backspace:8,tab:9,clear:12,enter:13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,ins:45,insert:45,home:36,end:35,pageup:33,pagedown:34,capslock:20,num_0:96,num_1:97,num_2:98,num_3:99,num_4:100,num_5:101,num_6:102,num_7:103,num_8:104,num_9:105,num_multiply:106,num_add:107,num_enter:108,num_subtract:109,num_decimal:110,num_divide:111,"⇪":20,",":188,".":190,"/":191,"`":192,"-":L?173:189,"=":L?61:187,";":L?59:186,"'":222,"[":219,"]":221,"\\":220},B={"⇧":16,shift:16,"⌥":18,alt:18,option:18,"⌃":17,ctrl:17,control:17,"⌘":91,cmd:91,command:91},z={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey",shiftKey:16,ctrlKey:17,altKey:18,metaKey:91},W={16:!1,18:!1,17:!1,91:!1},U={},G=1;G<20;G++)_["f".concat(G)]=111+G;var K=[],N="all",Y=[],X=function(e){return _[e.toLowerCase()]||B[e.toLowerCase()]||e.toUpperCase().charCodeAt(0)};function H(e){N=e||"all"}function $(){return N||"all"}function Z(){return K.slice(0)}function q(e){var t=e.target||e.srcElement,r=t.tagName,n=!0;return!t.isContentEditable&&("INPUT"!==r&&"TEXTAREA"!==r&&"SELECT"!==r||t.readOnly)||(n=!1),n}function V(e){return"string"===typeof e&&(e=X(e)),-1!==K.indexOf(e)}function J(e,t){var r,n;for(var i in e||(e=$()),U)if(Object.prototype.hasOwnProperty.call(U,i))for(r=U[i],n=0;n<r.length;)r[n].scope===e?r.splice(n,1):n++;$()===e&&H(t||"all")}function Q(e){var t=e.keyCode||e.which||e.charCode,r=K.indexOf(t);if(r>=0&&K.splice(r,1),e.key&&"meta"===e.key.toLowerCase()&&K.splice(0,K.length),93!==t&&224!==t||(t=91),t in W)for(var n in W[t]=!1,B)B[n]===t&&(oe[n]=!1)}function ee(e){if(e){if(Array.isArray(e))e.forEach((function(e){e.key&&te(e)}));else if("object"===typeof e)e.key&&te(e);else if("string"===typeof e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var i=r[0],o=r[1];"function"===typeof i&&(o=i,i=""),te({key:e,scope:i,method:o,splitKey:"+"})}}else Object.keys(U).forEach((function(e){return delete U[e]}))}var te=function(e){var t=e.key,r=e.scope,n=e.method,i=e.splitKey,o=void 0===i?"+":i,a=I(t);a.forEach((function(e){var t=e.split(o),i=t.length,a=t[i-1],s="*"===a?"*":X(a);if(U[s]){r||(r=$());var u=i>1?R(B,t):[];U[s]=U[s].map((function(e){var t=!n||e.method===n;return t&&e.scope===r&&F(e.mods,u)?{}:e}))}}))};function re(e,t,r){var n;if(t.scope===r||"all"===t.scope){for(var i in n=t.mods.length>0,W)Object.prototype.hasOwnProperty.call(W,i)&&(!W[i]&&t.mods.indexOf(+i)>-1||W[i]&&-1===t.mods.indexOf(+i))&&(n=!1);(0!==t.mods.length||W[16]||W[18]||W[17]||W[91])&&!n&&"*"!==t.shortcut||!1===t.method(e,t)&&(e.preventDefault?e.preventDefault():e.returnValue=!1,e.stopPropagation&&e.stopPropagation(),e.cancelBubble&&(e.cancelBubble=!0))}}function ne(e){var t=U["*"],r=e.keyCode||e.which||e.charCode;if(oe.filter.call(this,e)){if(93!==r&&224!==r||(r=91),-1===K.indexOf(r)&&229!==r&&K.push(r),["ctrlKey","altKey","shiftKey","metaKey"].forEach((function(t){var r=z[t];e[t]&&-1===K.indexOf(r)?K.push(r):!e[t]&&K.indexOf(r)>-1?K.splice(K.indexOf(r),1):"metaKey"===t&&e[t]&&3===K.length&&(e.ctrlKey||e.shiftKey||e.altKey||(K=K.slice(K.indexOf(r))))})),r in W){for(var n in W[r]=!0,B)B[n]===r&&(oe[n]=!0);if(!t)return}for(var i in W)Object.prototype.hasOwnProperty.call(W,i)&&(W[i]=e[z[i]]);e.getModifierState&&(!e.altKey||e.ctrlKey)&&e.getModifierState("AltGraph")&&(-1===K.indexOf(17)&&K.push(17),-1===K.indexOf(18)&&K.push(18),W[17]=!0,W[18]=!0);var o=$();if(t)for(var a=0;a<t.length;a++)t[a].scope===o&&("keydown"===e.type&&t[a].keydown||"keyup"===e.type&&t[a].keyup)&&re(e,t[a],o);if(r in U)for(var s=0;s<U[r].length;s++)if(("keydown"===e.type&&U[r][s].keydown||"keyup"===e.type&&U[r][s].keyup)&&U[r][s].key){for(var u=U[r][s],l=u.splitKey,c=u.key.split(l),h=[],f=0;f<c.length;f++)h.push(X(c[f]));h.sort().join("")===K.sort().join("")&&re(e,u,o)}}}function ie(e){return Y.indexOf(e)>-1}function oe(e,t,r){K=[];var n=I(e),i=[],o="all",a=document,s=0,u=!1,l=!0,c="+";for(void 0===r&&"function"===typeof t&&(r=t),"[object Object]"===Object.prototype.toString.call(t)&&(t.scope&&(o=t.scope),t.element&&(a=t.element),t.keyup&&(u=t.keyup),void 0!==t.keydown&&(l=t.keydown),"string"===typeof t.splitKey&&(c=t.splitKey)),"string"===typeof t&&(o=t);s<n.length;s++)e=n[s].split(c),i=[],e.length>1&&(i=R(B,e)),e=e[e.length-1],e="*"===e?"*":X(e),e in U||(U[e]=[]),U[e].push({keyup:u,keydown:l,scope:o,mods:i,shortcut:n[s],method:r,key:n[s],splitKey:c});"undefined"!==typeof a&&!ie(a)&&window&&(Y.push(a),E(a,"keydown",(function(e){ne(e)})),E(window,"focus",(function(){K=[]})),E(a,"keyup",(function(e){ne(e),Q(e)})))}var ae={setScope:H,getScope:$,deleteScope:J,getPressedKeyCodes:Z,isPressed:V,filter:q,unbind:ee};for(var se in ae)Object.prototype.hasOwnProperty.call(ae,se)&&(oe[se]=ae[se]);if("undefined"!==typeof window){var ue=window.hotkeys;oe.noConflict=function(e){return e&&window.hotkeys===oe&&(window.hotkeys=ue),oe},window.hotkeys=oe}var le="object"==typeof s&&s&&s.Object===Object&&s,ce=le,he=ce,fe="object"==typeof self&&self&&self.Object===Object&&self,ve=he||fe||Function("return this")(),ye=ve,pe=ye,de=pe.Symbol,me=de,ge=me,be=Object.prototype,we=be.hasOwnProperty,xe=be.toString,ke=ge?ge.toStringTag:void 0;function Oe(e){var t=we.call(e,ke),r=e[ke];try{e[ke]=void 0;var n=!0}catch(o){}var i=xe.call(e);return n&&(t?e[ke]=r:delete e[ke]),i}var Pe=Oe,Se=Object.prototype,De=Se.toString;function je(e){return De.call(e)}var Ce=je,Ae=me,Me=Pe,Te=Ce,Le="[object Null]",Ee="[object Undefined]",Re=Ae?Ae.toStringTag:void 0;function Ie(e){return null==e?void 0===e?Ee:Le:Re&&Re in Object(e)?Me(e):Te(e)}var Fe=Ie;function _e(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}var Be=_e,ze=Fe,We=Be,Ue="[object AsyncFunction]",Ge="[object Function]",Ke="[object GeneratorFunction]",Ne="[object Proxy]";function Ye(e){if(!We(e))return!1;var t=ze(e);return t==Ge||t==Ke||t==Ue||t==Ne}var Xe=Ye,He=ye,$e=He["__core-js_shared__"],Ze=$e,qe=Ze,Ve=function(){var e=/[^.]+$/.exec(qe&&qe.keys&&qe.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function Je(e){return!!Ve&&Ve in e}var Qe=Je,et=Function.prototype,tt=et.toString;function rt(e){if(null!=e){try{return tt.call(e)}catch(t){}try{return e+""}catch(t){}}return""}var nt=rt,it=Xe,ot=Qe,at=Be,st=nt,ut=/[\\^$.*+?()[\]{}|]/g,lt=/^\[object .+?Constructor\]$/,ct=Function.prototype,ht=Object.prototype,ft=ct.toString,vt=ht.hasOwnProperty,yt=RegExp("^"+ft.call(vt).replace(ut,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function pt(e){if(!at(e)||ot(e))return!1;var t=it(e)?yt:lt;return t.test(st(e))}var dt=pt;function mt(e,t){return null==e?void 0:e[t]}var gt=mt,bt=dt,wt=gt;function xt(e,t){var r=wt(e,t);return bt(r)?r:void 0}var kt=xt,Ot=kt,Pt=function(){try{var e=Ot(Object,"defineProperty");return e({},"",{}),e}catch(t){}}(),St=Pt,Dt=St;function jt(e,t,r){"__proto__"==t&&Dt?Dt(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}var Ct=jt;function At(e,t){return e===t||e!==e&&t!==t}var Mt=At,Tt=Ct,Lt=Mt,Et=Object.prototype,Rt=Et.hasOwnProperty;function It(e,t,r){var n=e[t];Rt.call(e,t)&&Lt(n,r)&&(void 0!==r||t in e)||Tt(e,t,r)}var Ft=It,_t=Ft,Bt=Ct;function zt(e,t,r,n){var i=!r;r||(r={});var o=-1,a=t.length;while(++o<a){var s=t[o],u=n?n(r[s],e[s],s,r,e):void 0;void 0===u&&(u=e[s]),i?Bt(r,s,u):_t(r,s,u)}return r}var Wt=zt;function Ut(e){return e}var Gt=Ut;function Kt(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}var Nt=Kt,Yt=Nt,Xt=Math.max;function Ht(e,t,r){return t=Xt(void 0===t?e.length-1:t,0),function(){var n=arguments,i=-1,o=Xt(n.length-t,0),a=Array(o);while(++i<o)a[i]=n[t+i];i=-1;var s=Array(t+1);while(++i<t)s[i]=n[i];return s[t]=r(a),Yt(e,this,s)}}var $t=Ht;function Zt(e){return function(){return e}}var qt=Zt,Vt=qt,Jt=St,Qt=Gt,er=Jt?function(e,t){return Jt(e,"toString",{configurable:!0,enumerable:!1,value:Vt(t),writable:!0})}:Qt,tr=er,rr=800,nr=16,ir=Date.now;function or(e){var t=0,r=0;return function(){var n=ir(),i=nr-(n-r);if(r=n,i>0){if(++t>=rr)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var ar=or,sr=tr,ur=ar,lr=ur(sr),cr=lr,hr=Gt,fr=$t,vr=cr;function yr(e,t){return vr(fr(e,t,hr),e+"")}var pr=yr,dr=9007199254740991;function mr(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=dr}var gr=mr,br=Xe,wr=gr;function xr(e){return null!=e&&wr(e.length)&&!br(e)}var kr=xr,Or=9007199254740991,Pr=/^(?:0|[1-9]\d*)$/;function Sr(e,t){var r=typeof e;return t=null==t?Or:t,!!t&&("number"==r||"symbol"!=r&&Pr.test(e))&&e>-1&&e%1==0&&e<t}var Dr=Sr,jr=Mt,Cr=kr,Ar=Dr,Mr=Be;function Tr(e,t,r){if(!Mr(r))return!1;var n=typeof t;return!!("number"==n?Cr(r)&&Ar(t,r.length):"string"==n&&t in r)&&jr(r[t],e)}var Lr=Tr,Er=pr,Rr=Lr;function Ir(e){return Er((function(t,r){var n=-1,i=r.length,o=i>1?r[i-1]:void 0,a=i>2?r[2]:void 0;o=e.length>3&&"function"==typeof o?(i--,o):void 0,a&&Rr(r[0],r[1],a)&&(o=i<3?void 0:o,i=1),t=Object(t);while(++n<i){var s=r[n];s&&e(t,s,n,o)}return t}))}var Fr=Ir,_r=Object.prototype;function Br(e){var t=e&&e.constructor,r="function"==typeof t&&t.prototype||_r;return e===r}var zr=Br;function Wr(e,t){var r=-1,n=Array(e);while(++r<e)n[r]=t(r);return n}var Ur=Wr;function Gr(e){return null!=e&&"object"==typeof e}var Kr=Gr,Nr=Fe,Yr=Kr,Xr="[object Arguments]";function Hr(e){return Yr(e)&&Nr(e)==Xr}var $r=Hr,Zr=$r,qr=Kr,Vr=Object.prototype,Jr=Vr.hasOwnProperty,Qr=Vr.propertyIsEnumerable,en=Zr(function(){return arguments}())?Zr:function(e){return qr(e)&&Jr.call(e,"callee")&&!Qr.call(e,"callee")},tn=en,rn=Array.isArray,nn=rn,on={exports:{}};function an(){return!1}var sn=an;(function(e,t){var r=ye,n=sn,i=t&&!t.nodeType&&t,o=i&&e&&!e.nodeType&&e,a=o&&o.exports===i,s=a?r.Buffer:void 0,u=s?s.isBuffer:void 0,l=u||n;e.exports=l})(on,on.exports);var un=Fe,ln=gr,cn=Kr,hn="[object Arguments]",fn="[object Array]",vn="[object Boolean]",yn="[object Date]",pn="[object Error]",dn="[object Function]",mn="[object Map]",gn="[object Number]",bn="[object Object]",wn="[object RegExp]",xn="[object Set]",kn="[object String]",On="[object WeakMap]",Pn="[object ArrayBuffer]",Sn="[object DataView]",Dn="[object Float32Array]",jn="[object Float64Array]",Cn="[object Int8Array]",An="[object Int16Array]",Mn="[object Int32Array]",Tn="[object Uint8Array]",Ln="[object Uint8ClampedArray]",En="[object Uint16Array]",Rn="[object Uint32Array]",In={};function Fn(e){return cn(e)&&ln(e.length)&&!!In[un(e)]}In[Dn]=In[jn]=In[Cn]=In[An]=In[Mn]=In[Tn]=In[Ln]=In[En]=In[Rn]=!0,In[hn]=In[fn]=In[Pn]=In[vn]=In[Sn]=In[yn]=In[pn]=In[dn]=In[mn]=In[gn]=In[bn]=In[wn]=In[xn]=In[kn]=In[On]=!1;var _n=Fn;function Bn(e){return function(t){return e(t)}}var zn=Bn,Wn={exports:{}};(function(e,t){var r=ce,n=t&&!t.nodeType&&t,i=n&&e&&!e.nodeType&&e,o=i&&i.exports===n,a=o&&r.process,s=function(){try{var e=i&&i.require&&i.require("util").types;return e||a&&a.binding&&a.binding("util")}catch(t){}}();e.exports=s})(Wn,Wn.exports);var Un=_n,Gn=zn,Kn=Wn.exports,Nn=Kn&&Kn.isTypedArray,Yn=Nn?Gn(Nn):Un,Xn=Yn,Hn=Ur,$n=tn,Zn=nn,qn=on.exports,Vn=Dr,Jn=Xn,Qn=Object.prototype,ei=Qn.hasOwnProperty;function ti(e,t){var r=Zn(e),n=!r&&$n(e),i=!r&&!n&&qn(e),o=!r&&!n&&!i&&Jn(e),a=r||n||i||o,s=a?Hn(e.length,String):[],u=s.length;for(var l in e)!t&&!ei.call(e,l)||a&&("length"==l||i&&("offset"==l||"parent"==l)||o&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||Vn(l,u))||s.push(l);return s}var ri=ti;function ni(e,t){return function(r){return e(t(r))}}var ii=ni,oi=ii,ai=oi(Object.keys,Object),si=ai,ui=zr,li=si,ci=Object.prototype,hi=ci.hasOwnProperty;function fi(e){if(!ui(e))return li(e);var t=[];for(var r in Object(e))hi.call(e,r)&&"constructor"!=r&&t.push(r);return t}var vi=fi,yi=ri,pi=vi,di=kr;function mi(e){return di(e)?yi(e):pi(e)}var gi=mi,bi=Ft,wi=Wt,xi=Fr,ki=kr,Oi=zr,Pi=gi,Si=Object.prototype,Di=Si.hasOwnProperty,ji=xi((function(e,t){if(Oi(t)||ki(t))wi(t,Pi(t),e);else for(var r in t)Di.call(t,r)&&bi(e,r,t[r])})),Ci=ji;function Ai(e,t){var r=-1,n=null==e?0:e.length,i=Array(n);while(++r<n)i[r]=t(e[r],r,e);return i}var Mi=Ai,Ti=Fe,Li=Kr,Ei="[object Symbol]";function Ri(e){return"symbol"==typeof e||Li(e)&&Ti(e)==Ei}var Ii=Ri,Fi=me,_i=Mi,Bi=nn,zi=Ii,Wi=1/0,Ui=Fi?Fi.prototype:void 0,Gi=Ui?Ui.toString:void 0;function Ki(e){if("string"==typeof e)return e;if(Bi(e))return _i(e,Ki)+"";if(zi(e))return Gi?Gi.call(e):"";var t=e+"";return"0"==t&&1/e==-Wi?"-0":t}var Ni=Ki,Yi=Ni;function Xi(e){return null==e?"":Yi(e)}var Hi=Xi,$i=Hi,Zi=0;function qi(e){var t=++Zi;return $i(e)+t}var Vi=qi;function Ji(e,t){var r=-1,n=null==e?0:e.length;while(++r<n)if(!1===t(e[r],r,e))break;return e}var Qi=Ji;function eo(e){return function(t,r,n){var i=-1,o=Object(t),a=n(t),s=a.length;while(s--){var u=a[e?s:++i];if(!1===r(o[u],u,o))break}return t}}var to=eo,ro=to,no=ro(),io=no,oo=io,ao=gi;function so(e,t){return e&&oo(e,t,ao)}var uo=so,lo=kr;function co(e,t){return function(r,n){if(null==r)return r;if(!lo(r))return e(r,n);var i=r.length,o=t?i:-1,a=Object(r);while(t?o--:++o<i)if(!1===n(a[o],o,a))break;return r}}var ho=co,fo=uo,vo=ho,yo=vo(fo),po=yo,mo=Gt;function go(e){return"function"==typeof e?e:mo}var bo=go,wo=Qi,xo=po,ko=bo,Oo=nn;function Po(e,t){var r=Oo(e)?wo:xo;return r(e,ko(t))}var So=Po,Do=nn,jo=Ii,Co=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ao=/^\w*$/;function Mo(e,t){if(Do(e))return!1;var r=typeof e;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=e&&!jo(e))||(Ao.test(e)||!Co.test(e)||null!=t&&e in Object(t))}var To=Mo,Lo=kt,Eo=Lo(Object,"create"),Ro=Eo,Io=Ro;function Fo(){this.__data__=Io?Io(null):{},this.size=0}var _o=Fo;function Bo(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var zo=Bo,Wo=Ro,Uo="__lodash_hash_undefined__",Go=Object.prototype,Ko=Go.hasOwnProperty;function No(e){var t=this.__data__;if(Wo){var r=t[e];return r===Uo?void 0:r}return Ko.call(t,e)?t[e]:void 0}var Yo=No,Xo=Ro,Ho=Object.prototype,$o=Ho.hasOwnProperty;function Zo(e){var t=this.__data__;return Xo?void 0!==t[e]:$o.call(t,e)}var qo=Zo,Vo=Ro,Jo="__lodash_hash_undefined__";function Qo(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=Vo&&void 0===t?Jo:t,this}var ea=Qo,ta=_o,ra=zo,na=Yo,ia=qo,oa=ea;function aa(e){var t=-1,r=null==e?0:e.length;this.clear();while(++t<r){var n=e[t];this.set(n[0],n[1])}}aa.prototype.clear=ta,aa.prototype["delete"]=ra,aa.prototype.get=na,aa.prototype.has=ia,aa.prototype.set=oa;var sa=aa;function ua(){this.__data__=[],this.size=0}var la=ua,ca=Mt;function ha(e,t){var r=e.length;while(r--)if(ca(e[r][0],t))return r;return-1}var fa=ha,va=fa,ya=Array.prototype,pa=ya.splice;function da(e){var t=this.__data__,r=va(t,e);if(r<0)return!1;var n=t.length-1;return r==n?t.pop():pa.call(t,r,1),--this.size,!0}var ma=da,ga=fa;function ba(e){var t=this.__data__,r=ga(t,e);return r<0?void 0:t[r][1]}var wa=ba,xa=fa;function ka(e){return xa(this.__data__,e)>-1}var Oa=ka,Pa=fa;function Sa(e,t){var r=this.__data__,n=Pa(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this}var Da=Sa,ja=la,Ca=ma,Aa=wa,Ma=Oa,Ta=Da;function La(e){var t=-1,r=null==e?0:e.length;this.clear();while(++t<r){var n=e[t];this.set(n[0],n[1])}}La.prototype.clear=ja,La.prototype["delete"]=Ca,La.prototype.get=Aa,La.prototype.has=Ma,La.prototype.set=Ta;var Ea=La,Ra=kt,Ia=ye,Fa=Ra(Ia,"Map"),_a=Fa,Ba=sa,za=Ea,Wa=_a;function Ua(){this.size=0,this.__data__={hash:new Ba,map:new(Wa||za),string:new Ba}}var Ga=Ua;function Ka(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}var Na=Ka,Ya=Na;function Xa(e,t){var r=e.__data__;return Ya(t)?r["string"==typeof t?"string":"hash"]:r.map}var Ha=Xa,$a=Ha;function Za(e){var t=$a(this,e)["delete"](e);return this.size-=t?1:0,t}var qa=Za,Va=Ha;function Ja(e){return Va(this,e).get(e)}var Qa=Ja,es=Ha;function ts(e){return es(this,e).has(e)}var rs=ts,ns=Ha;function is(e,t){var r=ns(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this}var os=is,as=Ga,ss=qa,us=Qa,ls=rs,cs=os;function hs(e){var t=-1,r=null==e?0:e.length;this.clear();while(++t<r){var n=e[t];this.set(n[0],n[1])}}hs.prototype.clear=as,hs.prototype["delete"]=ss,hs.prototype.get=us,hs.prototype.has=ls,hs.prototype.set=cs;var fs=hs,vs=fs,ys="Expected a function";function ps(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError(ys);var r=function(){var n=arguments,i=t?t.apply(this,n):n[0],o=r.cache;if(o.has(i))return o.get(i);var a=e.apply(this,n);return r.cache=o.set(i,a)||o,a};return r.cache=new(ps.Cache||vs),r}ps.Cache=vs;var ds=ps,ms=ds,gs=500;function bs(e){var t=ms(e,(function(e){return r.size===gs&&r.clear(),e})),r=t.cache;return t}var ws=bs,xs=ws,ks=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Os=/\\(\\)?/g,Ps=xs((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(ks,(function(e,r,n,i){t.push(n?i.replace(Os,"$1"):r||e)})),t})),Ss=Ps,Ds=nn,js=To,Cs=Ss,As=Hi;function Ms(e,t){return Ds(e)?e:js(e,t)?[e]:Cs(As(e))}var Ts=Ms,Ls=Ii,Es=1/0;function Rs(e){if("string"==typeof e||Ls(e))return e;var t=e+"";return"0"==t&&1/e==-Es?"-0":t}var Is=Rs,Fs=Ts,_s=Is;function Bs(e,t){t=Fs(t,e);var r=0,n=t.length;while(null!=e&&r<n)e=e[_s(t[r++])];return r&&r==n?e:void 0}var zs=Bs,Ws=zs;function Us(e,t,r){var n=null==e?void 0:Ws(e,t);return void 0===n?r:n}var Gs=Us,Ks=Fe,Ns=Kr,Ys="[object Number]";function Xs(e){return"number"==typeof e||Ns(e)&&Ks(e)==Ys}var Hs=Xs,$s=Ea;function Zs(){this.__data__=new $s,this.size=0}var qs=Zs;function Vs(e){var t=this.__data__,r=t["delete"](e);return this.size=t.size,r}var Js=Vs;function Qs(e){return this.__data__.get(e)}var eu=Qs;function tu(e){return this.__data__.has(e)}var ru=tu,nu=Ea,iu=_a,ou=fs,au=200;function su(e,t){var r=this.__data__;if(r instanceof nu){var n=r.__data__;if(!iu||n.length<au-1)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new ou(n)}return r.set(e,t),this.size=r.size,this}var uu=su,lu=Ea,cu=qs,hu=Js,fu=eu,vu=ru,yu=uu;function pu(e){var t=this.__data__=new lu(e);this.size=t.size}pu.prototype.clear=cu,pu.prototype["delete"]=hu,pu.prototype.get=fu,pu.prototype.has=vu,pu.prototype.set=yu;var du=pu,mu=Wt,gu=gi;function bu(e,t){return e&&mu(t,gu(t),e)}var wu=bu;function xu(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t}var ku=xu,Ou=Be,Pu=zr,Su=ku,Du=Object.prototype,ju=Du.hasOwnProperty;function Cu(e){if(!Ou(e))return Su(e);var t=Pu(e),r=[];for(var n in e)("constructor"!=n||!t&&ju.call(e,n))&&r.push(n);return r}var Au=Cu,Mu=ri,Tu=Au,Lu=kr;function Eu(e){return Lu(e)?Mu(e,!0):Tu(e)}var Ru=Eu,Iu=Wt,Fu=Ru;function _u(e,t){return e&&Iu(t,Fu(t),e)}var Bu=_u,zu={exports:{}};function Wu(e,t){var r=-1,n=e.length;t||(t=Array(n));while(++r<n)t[r]=e[r];return t}(function(e,t){var r=ye,n=t&&!t.nodeType&&t,i=n&&e&&!e.nodeType&&e,o=i&&i.exports===n,a=o?r.Buffer:void 0,s=a?a.allocUnsafe:void 0;function u(e,t){if(t)return e.slice();var r=e.length,n=s?s(r):new e.constructor(r);return e.copy(n),n}e.exports=u})(zu,zu.exports);var Uu=Wu;function Gu(e,t){var r=-1,n=null==e?0:e.length,i=0,o=[];while(++r<n){var a=e[r];t(a,r,e)&&(o[i++]=a)}return o}var Ku=Gu;function Nu(){return[]}var Yu=Nu,Xu=Ku,Hu=Yu,$u=Object.prototype,Zu=$u.propertyIsEnumerable,qu=Object.getOwnPropertySymbols,Vu=qu?function(e){return null==e?[]:(e=Object(e),Xu(qu(e),(function(t){return Zu.call(e,t)})))}:Hu,Ju=Vu,Qu=Wt,el=Ju;function tl(e,t){return Qu(e,el(e),t)}var rl=tl;function nl(e,t){var r=-1,n=t.length,i=e.length;while(++r<n)e[i+r]=t[r];return e}var il=nl,ol=ii,al=ol(Object.getPrototypeOf,Object),sl=al,ul=il,ll=sl,cl=Ju,hl=Yu,fl=Object.getOwnPropertySymbols,vl=fl?function(e){var t=[];while(e)ul(t,cl(e)),e=ll(e);return t}:hl,yl=vl,pl=Wt,dl=yl;function ml(e,t){return pl(e,dl(e),t)}var gl=ml,bl=il,wl=nn;function xl(e,t,r){var n=t(e);return wl(e)?n:bl(n,r(e))}var kl=xl,Ol=kl,Pl=Ju,Sl=gi;function Dl(e){return Ol(e,Sl,Pl)}var jl=Dl,Cl=kl,Al=yl,Ml=Ru;function Tl(e){return Cl(e,Ml,Al)}var Ll=Tl,El=kt,Rl=ye,Il=El(Rl,"DataView"),Fl=Il,_l=kt,Bl=ye,zl=_l(Bl,"Promise"),Wl=zl,Ul=kt,Gl=ye,Kl=Ul(Gl,"Set"),Nl=Kl,Yl=kt,Xl=ye,Hl=Yl(Xl,"WeakMap"),$l=Hl,Zl=Fl,ql=_a,Vl=Wl,Jl=Nl,Ql=$l,ec=Fe,tc=nt,rc="[object Map]",nc="[object Object]",ic="[object Promise]",oc="[object Set]",ac="[object WeakMap]",sc="[object DataView]",uc=tc(Zl),lc=tc(ql),cc=tc(Vl),hc=tc(Jl),fc=tc(Ql),vc=ec;(Zl&&vc(new Zl(new ArrayBuffer(1)))!=sc||ql&&vc(new ql)!=rc||Vl&&vc(Vl.resolve())!=ic||Jl&&vc(new Jl)!=oc||Ql&&vc(new Ql)!=ac)&&(vc=function(e){var t=ec(e),r=t==nc?e.constructor:void 0,n=r?tc(r):"";if(n)switch(n){case uc:return sc;case lc:return rc;case cc:return ic;case hc:return oc;case fc:return ac}return t});var yc=vc,pc=Object.prototype,dc=pc.hasOwnProperty;function mc(e){var t=e.length,r=new e.constructor(t);return t&&"string"==typeof e[0]&&dc.call(e,"index")&&(r.index=e.index,r.input=e.input),r}var gc=mc,bc=ye,wc=bc.Uint8Array,xc=wc,kc=xc;function Oc(e){var t=new e.constructor(e.byteLength);return new kc(t).set(new kc(e)),t}var Pc=Oc,Sc=Pc;function Dc(e,t){var r=t?Sc(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}var jc=Dc,Cc=/\w*$/;function Ac(e){var t=new e.constructor(e.source,Cc.exec(e));return t.lastIndex=e.lastIndex,t}var Mc=Ac,Tc=me,Lc=Tc?Tc.prototype:void 0,Ec=Lc?Lc.valueOf:void 0;function Rc(e){return Ec?Object(Ec.call(e)):{}}var Ic=Rc,Fc=Pc;function _c(e,t){var r=t?Fc(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}var Bc=_c,zc=Pc,Wc=jc,Uc=Mc,Gc=Ic,Kc=Bc,Nc="[object Boolean]",Yc="[object Date]",Xc="[object Map]",Hc="[object Number]",$c="[object RegExp]",Zc="[object Set]",qc="[object String]",Vc="[object Symbol]",Jc="[object ArrayBuffer]",Qc="[object DataView]",eh="[object Float32Array]",th="[object Float64Array]",rh="[object Int8Array]",nh="[object Int16Array]",ih="[object Int32Array]",oh="[object Uint8Array]",ah="[object Uint8ClampedArray]",sh="[object Uint16Array]",uh="[object Uint32Array]";function lh(e,t,r){var n=e.constructor;switch(t){case Jc:return zc(e);case Nc:case Yc:return new n(+e);case Qc:return Wc(e,r);case eh:case th:case rh:case nh:case ih:case oh:case ah:case sh:case uh:return Kc(e,r);case Xc:return new n;case Hc:case qc:return new n(e);case $c:return Uc(e);case Zc:return new n;case Vc:return Gc(e)}}var ch=lh,hh=Be,fh=Object.create,vh=function(){function e(){}return function(t){if(!hh(t))return{};if(fh)return fh(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}(),yh=vh,ph=yh,dh=sl,mh=zr;function gh(e){return"function"!=typeof e.constructor||mh(e)?{}:ph(dh(e))}var bh=gh,wh=yc,xh=Kr,kh="[object Map]";function Oh(e){return xh(e)&&wh(e)==kh}var Ph=Oh,Sh=Ph,Dh=zn,jh=Wn.exports,Ch=jh&&jh.isMap,Ah=Ch?Dh(Ch):Sh,Mh=Ah,Th=yc,Lh=Kr,Eh="[object Set]";function Rh(e){return Lh(e)&&Th(e)==Eh}var Ih=Rh,Fh=Ih,_h=zn,Bh=Wn.exports,zh=Bh&&Bh.isSet,Wh=zh?_h(zh):Fh,Uh=Wh,Gh=du,Kh=Qi,Nh=Ft,Yh=wu,Xh=Bu,Hh=zu.exports,$h=Uu,Zh=rl,qh=gl,Vh=jl,Jh=Ll,Qh=yc,ef=gc,tf=ch,rf=bh,nf=nn,of=on.exports,af=Mh,sf=Be,uf=Uh,lf=gi,cf=Ru,hf=1,ff=2,vf=4,yf="[object Arguments]",pf="[object Array]",df="[object Boolean]",mf="[object Date]",gf="[object Error]",bf="[object Function]",wf="[object GeneratorFunction]",xf="[object Map]",kf="[object Number]",Of="[object Object]",Pf="[object RegExp]",Sf="[object Set]",Df="[object String]",jf="[object Symbol]",Cf="[object WeakMap]",Af="[object ArrayBuffer]",Mf="[object DataView]",Tf="[object Float32Array]",Lf="[object Float64Array]",Ef="[object Int8Array]",Rf="[object Int16Array]",If="[object Int32Array]",Ff="[object Uint8Array]",_f="[object Uint8ClampedArray]",Bf="[object Uint16Array]",zf="[object Uint32Array]",Wf={};function Uf(e,t,r,n,i,o){var a,s=t&hf,u=t&ff,l=t&vf;if(r&&(a=i?r(e,n,i,o):r(e)),void 0!==a)return a;if(!sf(e))return e;var c=nf(e);if(c){if(a=ef(e),!s)return $h(e,a)}else{var h=Qh(e),f=h==bf||h==wf;if(of(e))return Hh(e,s);if(h==Of||h==yf||f&&!i){if(a=u||f?{}:rf(e),!s)return u?qh(e,Xh(a,e)):Zh(e,Yh(a,e))}else{if(!Wf[h])return i?e:{};a=tf(e,h,s)}}o||(o=new Gh);var v=o.get(e);if(v)return v;o.set(e,a),uf(e)?e.forEach((function(n){a.add(Uf(n,t,r,n,e,o))})):af(e)&&e.forEach((function(n,i){a.set(i,Uf(n,t,r,i,e,o))}));var y=l?u?Jh:Vh:u?cf:lf,p=c?void 0:y(e);return Kh(p||e,(function(n,i){p&&(i=n,n=e[i]),Nh(a,i,Uf(n,t,r,i,e,o))})),a}Wf[yf]=Wf[pf]=Wf[Af]=Wf[Mf]=Wf[df]=Wf[mf]=Wf[Tf]=Wf[Lf]=Wf[Ef]=Wf[Rf]=Wf[If]=Wf[xf]=Wf[kf]=Wf[Of]=Wf[Pf]=Wf[Sf]=Wf[Df]=Wf[jf]=Wf[Ff]=Wf[_f]=Wf[Bf]=Wf[zf]=!0,Wf[gf]=Wf[bf]=Wf[Cf]=!1;var Gf=Uf,Kf=Gf,Nf=1,Yf=4;function Xf(e){return Kf(e,Nf|Yf)}var Hf=Xf,$f=po;function Zf(e,t){var r=[];return $f(e,(function(e,n,i){t(e,n,i)&&r.push(e)})),r}var qf=Zf,Vf="__lodash_hash_undefined__";function Jf(e){return this.__data__.set(e,Vf),this}var Qf=Jf;function ev(e){return this.__data__.has(e)}var tv=ev,rv=fs,nv=Qf,iv=tv;function ov(e){var t=-1,r=null==e?0:e.length;this.__data__=new rv;while(++t<r)this.add(e[t])}ov.prototype.add=ov.prototype.push=nv,ov.prototype.has=iv;var av=ov;function sv(e,t){var r=-1,n=null==e?0:e.length;while(++r<n)if(t(e[r],r,e))return!0;return!1}var uv=sv;function lv(e,t){return e.has(t)}var cv=lv,hv=av,fv=uv,vv=cv,yv=1,pv=2;function dv(e,t,r,n,i,o){var a=r&yv,s=e.length,u=t.length;if(s!=u&&!(a&&u>s))return!1;var l=o.get(e),c=o.get(t);if(l&&c)return l==t&&c==e;var h=-1,f=!0,v=r&pv?new hv:void 0;o.set(e,t),o.set(t,e);while(++h<s){var y=e[h],p=t[h];if(n)var d=a?n(p,y,h,t,e,o):n(y,p,h,e,t,o);if(void 0!==d){if(d)continue;f=!1;break}if(v){if(!fv(t,(function(e,t){if(!vv(v,t)&&(y===e||i(y,e,r,n,o)))return v.push(t)}))){f=!1;break}}else if(y!==p&&!i(y,p,r,n,o)){f=!1;break}}return o["delete"](e),o["delete"](t),f}var mv=dv;function gv(e){var t=-1,r=Array(e.size);return e.forEach((function(e,n){r[++t]=[n,e]})),r}var bv=gv;function wv(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=e})),r}var xv=wv,kv=me,Ov=xc,Pv=Mt,Sv=mv,Dv=bv,jv=xv,Cv=1,Av=2,Mv="[object Boolean]",Tv="[object Date]",Lv="[object Error]",Ev="[object Map]",Rv="[object Number]",Iv="[object RegExp]",Fv="[object Set]",_v="[object String]",Bv="[object Symbol]",zv="[object ArrayBuffer]",Wv="[object DataView]",Uv=kv?kv.prototype:void 0,Gv=Uv?Uv.valueOf:void 0;function Kv(e,t,r,n,i,o,a){switch(r){case Wv:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case zv:return!(e.byteLength!=t.byteLength||!o(new Ov(e),new Ov(t)));case Mv:case Tv:case Rv:return Pv(+e,+t);case Lv:return e.name==t.name&&e.message==t.message;case Iv:case _v:return e==t+"";case Ev:var s=Dv;case Fv:var u=n&Cv;if(s||(s=jv),e.size!=t.size&&!u)return!1;var l=a.get(e);if(l)return l==t;n|=Av,a.set(e,t);var c=Sv(s(e),s(t),n,i,o,a);return a["delete"](e),c;case Bv:if(Gv)return Gv.call(e)==Gv.call(t)}return!1}var Nv=Kv,Yv=jl,Xv=1,Hv=Object.prototype,$v=Hv.hasOwnProperty;function Zv(e,t,r,n,i,o){var a=r&Xv,s=Yv(e),u=s.length,l=Yv(t),c=l.length;if(u!=c&&!a)return!1;var h=u;while(h--){var f=s[h];if(!(a?f in t:$v.call(t,f)))return!1}var v=o.get(e),y=o.get(t);if(v&&y)return v==t&&y==e;var p=!0;o.set(e,t),o.set(t,e);var d=a;while(++h<u){f=s[h];var m=e[f],g=t[f];if(n)var b=a?n(g,m,f,t,e,o):n(m,g,f,e,t,o);if(!(void 0===b?m===g||i(m,g,r,n,o):b)){p=!1;break}d||(d="constructor"==f)}if(p&&!d){var w=e.constructor,x=t.constructor;w==x||!("constructor"in e)||!("constructor"in t)||"function"==typeof w&&w instanceof w&&"function"==typeof x&&x instanceof x||(p=!1)}return o["delete"](e),o["delete"](t),p}var qv=Zv,Vv=du,Jv=mv,Qv=Nv,ey=qv,ty=yc,ry=nn,ny=on.exports,iy=Xn,oy=1,ay="[object Arguments]",sy="[object Array]",uy="[object Object]",ly=Object.prototype,cy=ly.hasOwnProperty;function hy(e,t,r,n,i,o){var a=ry(e),s=ry(t),u=a?sy:ty(e),l=s?sy:ty(t);u=u==ay?uy:u,l=l==ay?uy:l;var c=u==uy,h=l==uy,f=u==l;if(f&&ny(e)){if(!ny(t))return!1;a=!0,c=!1}if(f&&!c)return o||(o=new Vv),a||iy(e)?Jv(e,t,r,n,i,o):Qv(e,t,u,r,n,i,o);if(!(r&oy)){var v=c&&cy.call(e,"__wrapped__"),y=h&&cy.call(t,"__wrapped__");if(v||y){var p=v?e.value():e,d=y?t.value():t;return o||(o=new Vv),i(p,d,r,n,o)}}return!!f&&(o||(o=new Vv),ey(e,t,r,n,i,o))}var fy=hy,vy=fy,yy=Kr;function py(e,t,r,n,i){return e===t||(null==e||null==t||!yy(e)&&!yy(t)?e!==e&&t!==t:vy(e,t,r,n,py,i))}var dy=py,my=du,gy=dy,by=1,wy=2;function xy(e,t,r,n){var i=r.length,o=i,a=!n;if(null==e)return!o;e=Object(e);while(i--){var s=r[i];if(a&&s[2]?s[1]!==e[s[0]]:!(s[0]in e))return!1}while(++i<o){s=r[i];var u=s[0],l=e[u],c=s[1];if(a&&s[2]){if(void 0===l&&!(u in e))return!1}else{var h=new my;if(n)var f=n(l,c,u,e,t,h);if(!(void 0===f?gy(c,l,by|wy,n,h):f))return!1}}return!0}var ky=xy,Oy=Be;function Py(e){return e===e&&!Oy(e)}var Sy=Py,Dy=Sy,jy=gi;function Cy(e){var t=jy(e),r=t.length;while(r--){var n=t[r],i=e[n];t[r]=[n,i,Dy(i)]}return t}var Ay=Cy;function My(e,t){return function(r){return null!=r&&(r[e]===t&&(void 0!==t||e in Object(r)))}}var Ty=My,Ly=ky,Ey=Ay,Ry=Ty;function Iy(e){var t=Ey(e);return 1==t.length&&t[0][2]?Ry(t[0][0],t[0][1]):function(r){return r===e||Ly(r,e,t)}}var Fy=Iy;function _y(e,t){return null!=e&&t in Object(e)}var By=_y,zy=Ts,Wy=tn,Uy=nn,Gy=Dr,Ky=gr,Ny=Is;function Yy(e,t,r){t=zy(t,e);var n=-1,i=t.length,o=!1;while(++n<i){var a=Ny(t[n]);if(!(o=null!=e&&r(e,a)))break;e=e[a]}return o||++n!=i?o:(i=null==e?0:e.length,!!i&&Ky(i)&&Gy(a,i)&&(Uy(e)||Wy(e)))}var Xy=Yy,Hy=By,$y=Xy;function Zy(e,t){return null!=e&&$y(e,t,Hy)}var qy=Zy,Vy=dy,Jy=Gs,Qy=qy,ep=To,tp=Sy,rp=Ty,np=Is,ip=1,op=2;function ap(e,t){return ep(e)&&tp(t)?rp(np(e),t):function(r){var n=Jy(r,e);return void 0===n&&n===t?Qy(r,e):Vy(t,n,ip|op)}}var sp=ap;function up(e){return function(t){return null==t?void 0:t[e]}}var lp=up,cp=zs;function hp(e){return function(t){return cp(t,e)}}var fp=hp,vp=lp,yp=fp,pp=To,dp=Is;function mp(e){return pp(e)?vp(dp(e)):yp(e)}var gp=mp,bp=Fy,wp=sp,xp=Gt,kp=nn,Op=gp;function Pp(e){return"function"==typeof e?e:null==e?xp:"object"==typeof e?kp(e)?wp(e[0],e[1]):bp(e):Op(e)}var Sp=Pp,Dp=Ku,jp=qf,Cp=Sp,Ap=nn;function Mp(e,t){var r=Ap(e)?Dp:jp;return r(e,Cp(t))}var Tp,Lp,Ep,Rp,Ip,Fp,_p,Bp,zp,Wp=Mp;function Up(e){if(Array.isArray(e))return e}function Gp(e,t){var r=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o=[],a=!0,s=!1;try{for(r=r.call(e);!(a=(n=r.next()).done);a=!0)if(o.push(n.value),t&&o.length===t)break}catch(u){s=!0,i=u}finally{try{a||null==r["return"]||r["return"]()}finally{if(s)throw i}}return o}}function Kp(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Np(e,t){if(e){if("string"===typeof e)return Kp(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Kp(e,t):void 0}}function Yp(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Xp(e,t){return Up(e)||Gp(e,t)||Np(e,t)||Yp()}function Hp(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $p(e){return $p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},$p(e)}function Zp(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=$p(e),null===e)break;return e}function qp(){return qp="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=Zp(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}},qp.apply(this,arguments)}function Vp(e,t){return Vp=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Vp(e,t)}function Jp(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Vp(e,t)}function Qp(e){return Qp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Qp(e)}function ed(e,t){if(t&&("object"===Qp(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Hp(e)}(function(e){e["DOWN"]="down",e["UP"]="up",e["LEFT"]="left",e["RIGHT"]="right"})(Tp||(Tp={})),function(e){e["Left"]="left",e["Right"]="right"}(Lp||(Lp={})),function(e){e["Top"]="top",e["Bottom"]="bottom"}(Ep||(Ep={})),function(e){e["Bottom"]="bottom",e["Top"]="top",e["Middle"]="middle"}(Rp||(Rp={})),function(e){e["Pan"]="PAN",e["Ban"]="BAN",e["MARKER"]="MARKER",e["Point"]="POINT",e["Circle"]="CIRCLE",e["Line"]="LINE",e["Polyline"]="POLYLINE",e["Rect"]="RECT",e["Polygon"]="POLYGON",e["DrawMask"]="DRAWMASK",e["ClearMask"]="CLEARMASK",e["ImageMask"]="IMAGEMASK"}(Ip||(Ip={})),function(e){e["BoundsChanged"]="boundsChanged",e["FeatureSelected"]="featureSelected",e["FeatureUnselected"]="featureUnselected",e["DrawDone"]="drawDone",e["FeatureUpdated"]="featureUpdated",e["FeatureDeleted"]="featureDeleted",e["Draging"]="draging",e["Click"]="click",e["DblClick"]="dblClick",e["MouseDown"]="mouseDown",e["MouseMove"]="mouseMove",e["MouseUp"]="mouseUp",e["MouseOver"]="mouseOver",e["MouseOut"]="mouseOut"}(Fp||(Fp={})),function(e){e["DrawActivePoint"]="drawActivePoint",e["DrawActiveMiddlePoint"]="drawActiveMiddlePoint"}(_p||(_p={})),function(e){e["Grab"]="-webkit-grab",e["Grabbing"]="-webkit-grabbing",e["Crosshair"]="crosshair",e["Pointer"]="pointer",e["Move"]="move",e["NESW_Resize"]="nesw-resize",e["NWSE_Resize"]="nwse-resize"}(Bp||(Bp={})),function(e){e["DrawMask"]="crosshair",e["ClearMask"]="crosshair"}(zp||(zp={}));var td=po,rd=kr;function nd(e,t){var r=-1,n=rd(e)?Array(e.length):[];return td(e,(function(e,i,o){n[++r]=t(e,i,o)})),n}var id=nd,od=Mi,ad=Sp,sd=id,ud=nn;function ld(e,t){var r=ud(e)?od:sd;return r(e,ad(t))}var cd=ld;function hd(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}var fd=hd;function vd(e,t,r,n){var i=e.length,o=r+(n?1:-1);while(n?o--:++o<i)if(t(e[o],o,e))return o;return-1}var yd=vd;function pd(e){return e!==e}var dd=pd;function md(e,t,r){var n=r-1,i=e.length;while(++n<i)if(e[n]===t)return n;return-1}var gd=md,bd=yd,wd=dd,xd=gd;function kd(e,t,r){return t===t?xd(e,t,r):bd(e,wd,r)}var Od=kd,Pd=Fe,Sd=nn,Dd=Kr,jd="[object String]";function Cd(e){return"string"==typeof e||!Sd(e)&&Dd(e)&&Pd(e)==jd}var Ad=Cd,Md=/\s/;function Td(e){var t=e.length;while(t--&&Md.test(e.charAt(t)));return t}var Ld=Td,Ed=Ld,Rd=/^\s+/;function Id(e){return e?e.slice(0,Ed(e)+1).replace(Rd,""):e}var Fd=Id,_d=Fd,Bd=Be,zd=Ii,Wd=NaN,Ud=/^[-+]0x[0-9a-f]+$/i,Gd=/^0b[01]+$/i,Kd=/^0o[0-7]+$/i,Nd=parseInt;function Yd(e){if("number"==typeof e)return e;if(zd(e))return Wd;if(Bd(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Bd(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=_d(e);var r=Gd.test(e);return r||Kd.test(e)?Nd(e.slice(2),r?2:8):Ud.test(e)?Wd:+e}var Xd=Yd,Hd=Xd,$d=1/0,Zd=17976931348623157e292;function qd(e){if(!e)return 0===e?e:0;if(e=Hd(e),e===$d||e===-$d){var t=e<0?-1:1;return t*Zd}return e===e?e:0}var Vd=qd,Jd=Vd;function Qd(e){var t=Jd(e),r=t%1;return t===t?r?t-r:t:0}var em=Qd,tm=Mi;function rm(e,t){return tm(t,(function(t){return e[t]}))}var nm=rm,im=nm,om=gi;function am(e){return null==e?[]:im(e,om(e))}var sm=am,um=Od,lm=kr,cm=Ad,hm=em,fm=sm,vm=Math.max;function ym(e,t,r,n){e=lm(e)?e:fm(e),r=r&&!n?hm(r):0;var i=e.length;return r<0&&(r=vm(i+r,0)),cm(e)?r<=i&&e.indexOf(t,r)>-1:!!i&&um(e,t,r)>-1}var pm,dm=ym;(function(e){e["Draw"]="DRAW",e["Clear"]="CLEAR",e["Image"]="IMAGE"})(pm||(pm={}));var mm=function(){function e(t,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};n(this,e),this.id=t,this.type=r,this.props=i,this.style=Ci({},e.defaultStyle,o)}return o(e,[{key:"onAdd",value:function(e){this.layer=e,this.refresh()}},{key:"onRemove",value:function(){}},{key:"setStyle",value:function(e,t){var r,n=t.refresh,i=void 0===n||n;this.style=e,i&&(null===(r=this.layer)||void 0===r||r.refresh())}},{key:"refresh",value:function(){}},{key:"printInfo",value:function(){}}]),e}();a(mm,"defaultStyle",{opacity:1,fillStyle:"rgba(255, 0, 0, 0)",lineWidth:1,strokeStyle:"#000"});var gm=Fe,bm=Kr,wm="[object Boolean]";function xm(e){return!0===e||!1===e||bm(e)&&gm(e)==wm}var km=xm,Om=function(){function e(t,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};n(this,e),this.id=t,this.type=r,this.props=i,this.style=Ci({},e.defaultStyle,o),this.domId="layer-".concat(t,"-wrapper"),this.setDom()}return o(e,[{key:"setDom",value:function(){this.dom||(this.dom=document.createElement("div"),this.dom.setAttribute("id",this.domId),this.dom.style.position="absolute",this.dom.style.left="0",this.dom.style.top="0");var e=this.style,t=e.zIndex,r=e.opacity;this.dom.style.zIndex="".concat(t),this.dom.style.opacity="".concat(r)}},{key:"onAdd",value:function(e){this.map=e,this.resize()}},{key:"onRemove",value:function(){var e=document.getElementById(this.domId);e&&e.remove(),this.map=null}},{key:"resize",value:function(){var e=this.map.getSize(),t=e.width,r=e.height;this.dom.style.width="".concat(t,"px"),this.dom.style.height="".concat(r,"px")}},{key:"refresh",value:function(){}},{key:"resizeAndRefresh",value:function(){this.resize(),this.refresh()}},{key:"printInfo",value:function(){}}]),e}();function Pm(e){var t=Sm();return function(){var r,n=$p(e);if(t){var i=$p(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return ed(this,r)}}function Sm(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}a(Om,"defaultStyle",{zIndex:1,opacity:1});var Dm=function(e){Jp(r,e);var t=Pm(r);function r(e,i){var o,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return n(this,r),o=t.call(this,e,i,a,s),o.createRenderCanvas(),o}return o(r,[{key:"onAdd",value:function(e){qp($p(r.prototype),"onAdd",this).call(this,e),this.resize()}},{key:"createRenderCanvas",value:function(){this.canvas=document.createElement("canvas"),this.canvas.style.position="absolute",this.canvas.style.left="0",this.canvas.style.top="0",this.dom.appendChild(this.canvas),this.canvasContext=this.canvas.getContext("2d")}},{key:"resize",value:function(){qp($p(r.prototype),"resize",this).call(this);var e=this.map.getSize(),t=e.width,n=e.height;this.canvas.width=t*r.dpr,this.canvas.height=n*r.dpr,this.canvas.style.width=t+"px",this.canvas.style.height=n+"px"}},{key:"refresh",value:function(){this.clear(),qp($p(r.prototype),"refresh",this).call(this)}},{key:"clear",value:function(){var e;null===(e=this.canvasContext)||void 0===e||e.clearRect(0,0,this.canvas.width,this.canvas.height)}}]),r}(Om);function jm(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Cm(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?jm(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):jm(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}a(Dm,"dpr",window.devicePixelRatio);var Am=function(){function e(){n(this,e)}return o(e,null,[{key:"setStyle",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Ci({},e.defaultStyle,r);So(n,(function(r,n){if(Xe(e.formatStyle[n])){var i=e.formatStyle[n](r);!Xe(t[n])&&(t[n]=i)}else!Xe(t[n])&&(t[n]=r)}))}},{key:"drawPolyline",value:function(t,r,n,i){var o=i.format,a=i.limitCount,s=void 0===a?2:a,u=Xe(o)?o(r):r,l=u.points,c=u.width,h=l.length;if(!(h<s)){e.setStyle(t,n),Hs(c)&&(t.lineWidth=c),t.beginPath();var f=l[0],v=f.x,y=f.y;t.moveTo(v,y);for(var p=1;p<h;p++){var d=l[p],m=d.x,g=d.y;t.lineTo(m,g)}t.stroke()}}},{key:"drawLine",value:function(t,r,n,i){e.setStyle(t,n);var o=i||{},a=o.format,s=Xe(a)?a(r):r,u=s.start,l=s.end,c=s.width;Hs(c)&&(t.lineWidth=c),t.beginPath(),t.moveTo(u.x,u.y),t.lineTo(l.x,l.y),t.stroke()}},{key:"drawRect",value:function(t,r,n,i){var o=i||{},a=o.format,s=!km(n.stroke)||n.stroke,u=!!km(n.fill)&&n.fill,l=Xe(a)?a(r):r,c=l.x,h=l.y,f=l.width,v=l.height,y=c+f,p=h+v,d=[{x:c,y:h},{x:y,y:h},{x:y,y:p},{x:c,y:p}];e.drawPolygon(t,d,n,{fill:u,stroke:s})}},{key:"drawPolygon",value:function(t,r,n,i){var o=i.format,a=i.limitCount,s=void 0===a?2:a,u=i.closePath,l=void 0===u||u,c=!km(n.stroke)||n.stroke,h=!!km(n.fill)&&n.fill,f=r.length;if(!(f<s)){e.setStyle(t,n),t.beginPath();var v=Xe(o)?o(r[0]):r[0],y=v.x,p=v.y;t.moveTo(y,p);for(var d=1;d<f;d++){var m=Xe(o)?o(r[d]):r[d],g=m.x,b=m.y;t.lineTo(g,b)}l&&t.closePath(),h&&t.fill(),c&&(t.globalAlpha=1,t.stroke())}}},{key:"drawCircle",value:function(t,r,n,i){var o=i.format,a=!km(n.stroke)||n.stroke,s=!!km(n.fill)&&n.fill,u=Xe(o)?o(r):r,l=u.cx,c=u.cy,h=u.r;e.setStyle(t,n),t.beginPath(),t.arc(l,c,h,0,2*Math.PI),s&&t.fill(),a&&(t.globalAlpha=1,t.stroke())}},{key:"drawPoint",value:function(t,r,n,i){var o=i.format,a=Xe(o)?o(r):r,s=a.x,u=a.y,l=a.r,c=void 0===l?2:l;e.setStyle(t,n),t.beginPath(),t.arc(s,u,c,0,2*Math.PI),t.fill()}},{key:"drawImage",value:function(e,t,r){var n=t.image,i=t.x,o=t.y,a=t.width,s=t.height;e.drawImage(n,i,o,a,s)}},{key:"drawText",value:function(t,r,n,i){var o=n.background,a=i.format,s=!km(n.fill)||n.fill,u=Xe(a)?a(r):r,l=u.text,c=u.position,h=u.offset;if(l){e.setStyle(t,n);var f=c.x+h.x,v=c.y-h.y,y=t.lineWidth,p=3*Dm.dpr,d=4*Dm.dpr,m=t.textBaseline===Rp.Bottom,g=t.textBaseline===Rp.Top,b=t.textBaseline===Rp.Middle;if(o){var w=t.measureText(l).width,x=parseInt(t.font.replace(/[^0-9.]/gi,""),10),k=w+2*d,O=x+2*p,P=c.y;m&&(P-=O),g&&(P=P),b&&(P-=O/2);var S={x:c.x+h.x,y:P-h.y,width:k,height:O};e.drawRect(t,S,Cm(Cm({},n||{}),{},{fill:!0}))}t.globalAlpha=1,s?(t.fillStyle=n.fontColor,m&&o&&t.fillText(l,f+d,v-p+y),b&&o&&t.fillText(l,f+d,v),g&&o&&t.fillText(l,f+d,v+p+y),!o&&t.fillText(l,f,v)):(t.strokeStyle=n.fontColor,m&&o&&t.strokeText(l,f+d,v-p+y),b&&o&&t.strokeText(l,f+d,v),g&&o&&t.strokeText(l,f+d,v+p+y),!o&&t.strokeText(l,f,v))}}},{key:"drawArrow",value:function(t,r,n,i,o){var a=o||{},s=a.format,u=Xe(s)?s(r):r,l=u.position,c=u.points,h=void 0===c?[]:c;e.setStyle(t,i),t.save(),t.beginPath(),t.translate(l.x,l.y),t.rotate(n),So(h,(function(e,r){0===r?t.moveTo(e.x,e.y):t.lineTo(e.x,e.y)})),t.closePath(),t.restore(),t.fill(),t.stroke()}}]),e}();function Mm(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Tm(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Mm(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Mm(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Lm(e){var t=Em();return function(){var r,n=$p(e);if(t){var i=$p(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return ed(this,r)}}function Em(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}a(Am,"defaultStyle",{fillStyle:"#FF0000",strokeStyle:"#FF0000",lineWidth:1,font:"normal 12px Arial",globalAlpha:1,lineCap:"round",lineJoin:"round",shadowOffsetX:0,shadowOffsetY:0,shadowBlur:0}),a(Am,"formatStyle",{lineWidth:function(e){return e*Dm.dpr},font:function(e){var t=e.replace(/[^0-9.]/gi,""),r=parseInt(t,10)*Dm.dpr,n=new RegExp("".concat(t),"g"),i=e.replace(n,"".concat(r));return i}});var Rm,Im,Fm,_m,Bm=function(e){Jp(r,e);var t=Lm(r);function r(e,i){var o,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return n(this,r),o=t.call(this,e,pm.Clear,a,s),o.shape=i,o}return o(r,[{key:"refresh",value:function(){var e=this,t=Dm.dpr,r=this.layer.map.getScale(),n=Tm(Tm({},this.style||{}),{},{lineCap:"round",lineJoin:"round"});this.layer.canvasContext.globalCompositeOperation="destination-out",Am.drawPolyline(this.layer.canvasContext,this.shape,n,{format:function(n){var i=n.points,o=n.width;return Tm({points:cd(i,(function(r){var n=e.layer.map.transformGlobalToScreen(r),i=n.x,o=n.y;return{x:i*t,y:o*t}}))},Hs(o)?{width:o*r*t}:{})}}),this.layer.canvasContext.globalCompositeOperation="source-over"}}]),r}(mm);(function(e){e["Image"]="IMAGE",e["Feature"]="FEATURE",e["Event"]="EVENT",e["Mask"]="MASK",e["Text"]="TEXT",e["Marker"]="MARKER",e["Overlay"]="OVERLAY",e["Support"]="SUPPORT"})(Rm||(Rm={})),function(e){e["LoadStart"]="loadStart",e["LoadEnd"]="loadEnd",e["LoadError"]="loadError"}(Im||(Im={})),function(e){e["Point"]="POINT",e["Line"]="LINE",e["Polyline"]="POLYLINE",e["Polygon"]="POLYGON",e["Rect"]="RECT",e["Circle"]="CIRCLE",e["Arrow"]="ARROW"}(Fm||(Fm={})),function(e){e["Global"]="GLOBAL",e["Screen"]="SCREEN"}(_m||(_m={}));var zm,Wm,Um=o((function e(){n(this,e)}));function Gm(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Km(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Gm(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Gm(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Nm(e){var t=Ym();return function(){var r,n=$p(e);if(t){var i=$p(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return ed(this,r)}}function Ym(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}a(Um,"MathUtil",{getMiddlePoint:function(e,t){var r=e.x,n=e.y,i=t.x,o=t.y,a=(r+i)/2,s=(n+o)/2;return{x:a,y:s}},distance:function(e,t){var r=e.x,n=e.y,i=t.x,o=t.y,a=r-i,s=n-o;return Math.sqrt(a*a+s*s)},pointInPolygon:function(e,t){for(var r=e.x,n=e.y,i=!1,o=-1,a=t.length,s=a-1;++o<a;s=o){var u=t[o],l=u.x,c=u.y,h=t[s],f=h.x,v=h.y;(c<=n&&n<v||v<=n&&n<c)&&r<(f-l)*(n-c)/(v-c)+l&&(i=!i)}return i},pointInPoint:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=r.tolerance,i=Um.MathUtil.distance(e,t);return i<=n},pointInPolyline:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=r.tolerance,i=t.length-1,o=!1;return So(t,(function(r,a){if(a!==i){var s=t[a+1],u=Um.MathUtil.distancePoint2Line(e,r,s);return u<=n?(o=!0,!1):void 0}})),o},distancePoint2Line:function(e,t,r){var n,i,o=e.x,a=e.y,s=t.x,u=t.y,l=r.x,c=r.y,h=o-s,f=a-u,v=l-s,y=c-u,p=h*v+f*y,d=v*v+y*y,m=-1;0!==d&&(m=p/d),m<0?(n=s,i=u):m>1?(n=l,i=c):(n=s+m*v,i=u+m*y);var g=o-n,b=a-i;return Math.sqrt(g*g+b*b)}}),a(Um,"EventUtil",{getButtonIndex:function(e){if(!+[1])switch(e.button){case 0:case 1:case 3:case 5:case 7:return 0;case 2:case 6:return 2;case 4:return 1}return e.button},getMouseDirection:function(e,t){var r=e.offsetLeft,n=-e.offsetTop,i=r+e.offsetWidth,o=n-e.offsetHeight,a=(r+i)/2,s=(n+o)/2,u=(o-n)/(i-r),l=t||window.event,c=l.clientX,h=-l.clientY,f=(h-s)/(c-a);return u<f&&f<-u?c>a?1:3:h>s?0:2}}),function(e){e["Marker"]="MARKER"}(zm||(zm={})),function(e){e["Click"]="click",e["MouseDown"]="mouseDown",e["MouseUp"]="mouseUp",e["MouseOver"]="mouseOver",e["MouseOut"]="mouseOut",e["DragStart"]="dragStart",e["Dragging"]="dragging",e["DragEnd"]="dragEnd",e["RightClick"]="rightClick"}(Wm||(Wm={}));var Xm=function(e){Jp(r,e);var t=Nm(r);function r(e){var i,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return n(this,r),i=t.call(this,e,Rm.Event,o,s),a(Hp(i),"dragging",!1),a(Hp(i),"breakFeatureCapture",!1),a(Hp(i),"tmpPointsStore",[]),a(Hp(i),"hoverFeature",null),a(Hp(i),"hoverFeatureIndex",void 0),i.onMouseDown=i.onMouseDown.bind(Hp(i)),i.onMouseMove=i.onMouseMove.bind(Hp(i)),i.onMouseUp=i.onMouseUp.bind(Hp(i)),i.onMouseOut=i.onMouseOut.bind(Hp(i)),i.onMouseOver=i.onMouseOver.bind(Hp(i)),i.onMouseClick=i.onMouseClick.bind(Hp(i)),i.onMouseDblClick=i.onMouseDblClick.bind(Hp(i)),i.onMouseWheel=i.onMouseWheel.bind(Hp(i)),i}return o(r,[{key:"onAdd",value:function(e){qp($p(r.prototype),"onAdd",this).call(this,e),this.createEventDom(),this.dom.appendChild(this.eventDom),this.addEventListener()}},{key:"createEventDom",value:function(){this.eventDom=document.createElement("div"),this.eventDom.style.position="absolute",this.eventDom.style.left="0",this.eventDom.style.right="0",this.eventDom.style.top="0",this.eventDom.style.bottom="0",this.eventDom.style.zIndex="1",this.eventDom.ondragstart=function(e){e.preventDefault(),e.stopPropagation()}}},{key:"addEventListener",value:function(){this.eventDom.addEventListener("mousedown",this.onMouseDown),this.eventDom.addEventListener("mousemove",this.onMouseMove),this.eventDom.addEventListener("mouseup",this.onMouseUp),this.eventDom.addEventListener("click",this.onMouseClick),this.eventDom.addEventListener("dblclick",this.onMouseDblClick),this.eventDom.addEventListener("mousewheel",this.onMouseWheel),this.eventDom.addEventListener("mouseout",this.onMouseOut),this.eventDom.addEventListener("mouseover",this.onMouseOver)}},{key:"removeEventListener",value:function(){this.eventDom.removeEventListener("mousedown",this.onMouseDown),this.eventDom.removeEventListener("mousemove",this.onMouseMove),this.eventDom.removeEventListener("mouseup",this.onMouseUp),this.eventDom.removeEventListener("click",this.onMouseClick),this.eventDom.removeEventListener("dblclick",this.onMouseDblClick),this.eventDom.removeEventListener("mousewheel",this.onMouseWheel),this.eventDom.removeEventListener("mouseout",this.onMouseOut),this.eventDom.removeEventListener("mouseover",this.onMouseOver)}},{key:"handleMapPanStart",value:function(e){var t=this;this.dragging=!0,this.setEventCursor(Bp.Grabbing),document.onmousemove=function(e){return t.handleMapPanMove(e)},document.onmouseup=function(e){return t.handleMapPanEnd(e)}}},{key:"handleMapPanMove",value:function(e){var t=this.getDltXY(e),r=t.x,n=t.y;this.map.onDrag(r,n)}},{key:"handleMapPanEnd",value:function(e){this.dragging=!1,this.setEventCursor(Bp.Grab),document.onmousemove=null,document.onmouseup=null;var t=this.getDltXY(e),r=t.x,n=t.y,i=this.map.getScreenCenter(),o=i.x,a=i.y,s=o-r,u=a-n,l=this.map.transformScreenToGlobal({x:s,y:u});this.map.reset().setCenter(l)}},{key:"getDltXY",value:function(e,t){var r=t||{},n=r.transform,i=void 0!==n&&n,o=this.map.getScale(),a=e.screenX,s=e.screenY,u=this.startPageScreenPoint,l=u.x,c=u.y,h=a-l,f=s-c,v=h/o,y=f/o;return{x:i?v:h,y:i?y:f}}},{key:"clearDownTimer",value:function(){this.downTimer&&(window.clearTimeout(this.downTimer),this.downTimer=null)}},{key:"handleMarkerStart",value:function(e){var t=this;this.clearDownTimer(),this.downTimer=window.setTimeout((function(){t.map.eventsObServer.emit(Fp.DrawDone,t.map.mode,{x:t.startPoint.global.x,y:t.startPoint.global.y})}),300)}},{key:"handlePointStart",value:function(e){var t=this;this.clearDownTimer(),this.downTimer=window.setTimeout((function(){t.map.eventsObServer.emit(Fp.DrawDone,t.map.mode,{x:t.startPoint.global.x,y:t.startPoint.global.y}),t.reset()}),300)}},{key:"handleCircleStart",value:function(e){var t=this;this.dragging=!0,document.onmousemove=function(e){return t.handleCircleMove(e)},document.onmouseup=function(e){return t.handleCircleEnd(e)};var r=this.startPoint.global;this.setTip({text:"移动开始绘制",position:r})}},{key:"handleCircleMove",value:function(e){var t=this.startPoint.global,r=this.getDltXY(e,{transform:!0}),n=r.x,i=r.y,o=this.getDltXY(e,{transform:!1}),a=o.x,s=o.y,u=Math.sqrt(a*a+s*s),l=this.map.xAxis.direction===Lp.Right,c=this.map.yAxis.direction===Ep.Top,h=l?n:-n,f=c?i:-i,v={x:t.x+h,y:t.y-f},y={cx:t.x,cy:t.y,sr:u};this.map.overlayLayer.addCircleFeature(y),this.setTip({text:"抬起完成绘制",position:v})}},{key:"handleCircleEnd",value:function(e){this.dragging=!1,document.onmousemove=null,document.onmouseup=null;var t=this.startPoint.global,r=t.x,n=t.y,i=this.getDltXY(e,{transform:!0}),o=i.x,a=i.y,s=this.getDltXY(e,{transform:!1}),u=s.x,l=s.y,c=Math.sqrt(o*o+a*a),h=Math.sqrt(u*u+l*l);if(this.reset(),Math.abs(h)<=2)console.warn("the circle is too small...");else{var f={cx:r,cy:n,r:c},v={cx:r,cy:n,sr:h};this.map.eventsObServer.emit(Fp.DrawDone,this.map.mode,f,v)}}},{key:"handleLineStart",value:function(e){var t=this;if(0===this.tmpPointsStore.length)this.clearDownTimer(),this.downTimer=window.setTimeout((function(){t.tmpPointsStore.push(t.startPoint),t.setTip({text:"移动开始绘制",position:t.startPoint.global})}),300);else if(1===this.tmpPointsStore.length){var r=this.tmpPointsStore[0].global,n=this.startPoint.global;this.map.eventsObServer.emit(Fp.DrawDone,this.map.mode,{start:r,end:n}),this.reset()}}},{key:"handleLineMove",value:function(e){var t=e.offsetX,r=e.offsetY,n={x:t,y:r},i=this.map.transformScreenToGlobal(n),o=this.tmpPointsStore.length;if(0===o)this.setTip({text:"单击确定起点",position:i});else if(1===o){var a=this.tmpPointsStore[0].global,s=this.map.transformScreenToGlobal({x:t,y:r});this.map.overlayLayer.addLineFeature({start:a,end:s}),this.setTip({text:"单击确定终点",position:i})}}},{key:"handlePolylineStart",value:function(e){var t=this;0===this.tmpPointsStore.length?(this.clearDownTimer(),this.downTimer=window.setTimeout((function(){t.tmpPointsStore.push(t.startPoint),t.setTip({text:"移动开始绘制",position:t.startPoint.global})}),300)):(this.tmpPointsStore.push(this.startPoint),this.map.withHotKeys&&this.setTip({text:"ctrl+z撤销",position:this.startPoint.global}))}},{key:"handlePolylineMove",value:function(e){var t=e.offsetX,r=e.offsetY,n=this.map.transformScreenToGlobal({x:t,y:r}),i=cd(this.tmpPointsStore,(function(e){var t=e.global;return t}));i.push(n),1===i.length?this.setTip({text:"单击确定起点",position:n}):i.length>1&&(this.map.overlayLayer.addPolylineFeature({points:i}),this.setTip({text:"单击绘制/双击结束",position:n}))}},{key:"handlePolylineEnd",value:function(e){this.tmpPointsStore.pop(),this.tmpPointsStore.length>=2&&this.map.eventsObServer.emit(Fp.DrawDone,this.map.mode,cd(this.tmpPointsStore,(function(e){var t=e.global;return t}))),this.reset()}},{key:"handleRectStart",value:function(e){var t=this;this.dragging=!0,document.onmousemove=function(e){return t.handleRectMove(e)},document.onmouseup=function(e){return t.handleRectEnd(e)};var r=this.startPoint.global;this.setTip({text:"移动开始绘制",position:r})}},{key:"handleRectMove",value:function(e){var t=this.startPoint.global,r=t.x,n=t.y,i=this.getDltXY(e,{transform:!0}),o=i.x,a=i.y,s=this.map.xAxis.direction===Lp.Right,u=this.map.yAxis.direction===Ep.Top,l=s?Math.min(r,r+o):Math.max(r,r-o),c=u?Math.max(n,n-a):Math.min(n,n+a),h={x:s?r+o:r-o,y:u?n-a:n+a},f={x:l,y:c,width:Math.abs(o),height:Math.abs(a)};this.map.overlayLayer.addRectFeature(f),this.setTip({text:"抬起完成绘制",position:h})}},{key:"handleRectEnd",value:function(e){this.dragging=!1,document.onmousemove=null,document.onmouseup=null;var t=this.map.getScale(),r=this.startPoint.screen,n=r.x,i=r.y,o=this.getDltXY(e),a=o.x,s=o.y,u=Math.abs(a)/t,l=Math.abs(s)/t,c=n+a,h=i+s,f=Math.min(c,n),v=Math.min(h,i),y=this.map.transformScreenToGlobal({x:f,y:v});if(this.reset(),Math.abs(a)<=3||Math.abs(s)<=3)console.warn("the rect is too small...");else{var p={x:y.x,y:y.y,width:u,height:l};this.map.eventsObServer.emit(Fp.DrawDone,this.map.mode,p)}}},{key:"handlePolygonStart",value:function(e){var t=this;0===this.tmpPointsStore.length?(this.clearDownTimer(),this.downTimer=window.setTimeout((function(){t.tmpPointsStore.push(t.startPoint),t.setTip({text:"移动开始绘制",position:t.startPoint.global})}),300)):(this.tmpPointsStore.push(this.startPoint),this.map.withHotKeys&&this.setTip({text:"ctrl+z撤销",position:this.startPoint.global}))}},{key:"handlePolygonMove",value:function(e){var t=e.offsetX,r=e.offsetY,n=this.map.transformScreenToGlobal({x:t,y:r}),i=cd(this.tmpPointsStore,(function(e){var t=e.global;return t}));i.push(n);var o=i.length;if(1===o)this.setTip({text:"单击确定起点",position:n});else if(o>1){this.map.overlayLayer.addPolygonFeature({points:i},{node:!0});var a=2===o?"单击绘制":"单击绘制/双击结束";this.setTip({text:a,position:n})}}},{key:"handlePolygonEnd",value:function(e){if(this.tmpPointsStore.pop(),this.tmpPointsStore.length>=3){var t=cd(this.tmpPointsStore,(function(e){var t=e.global;return t}));this.map.eventsObServer.emit(Fp.DrawDone,this.map.mode,t)}this.reset()}},{key:"handleMaskStart",value:function(e){var t=this;this.dragging=!0,document.onmousemove=function(e){return t.handleMaskMove(e)},document.onmouseup=function(e){return t.handleMaskEnd(e)},this.tmpPointsStore.push(this.startPoint);var r=cd(this.tmpPointsStore,(function(e){var t=e.global;return t}));switch(this.map.mode){case Ip.DrawMask:this.map.overlayLayer.addDrawAction({points:r});break;case Ip.ClearMask:this.handleMaskClearMoving({points:r});break}}},{key:"handleMaskMove",value:function(e){var t=this.startPoint.screen,r=t.x,n=t.y,i=this.getDltXY(e),o=i.x,a=i.y,s={x:r+o,y:n+a},u=this.map.transformScreenToGlobal(s),l=fd(this.tmpPointsStore);if(l){var c=l.screen,h=Um.MathUtil.distance(c,s);if(h<=3)return}this.tmpPointsStore.push({screen:s,global:u});var f=cd(this.tmpPointsStore,(function(e){var t=e.global;return t}));switch(this.map.mode){case Ip.DrawMask:this.map.overlayLayer.addDrawAction({points:f});break;case Ip.ClearMask:this.handleMaskClearMoving({points:f});break}}},{key:"handleMaskEnd",value:function(e){this.dragging=!1,document.onmousemove=null,document.onmouseup=null;var t=cd(this.tmpPointsStore,(function(e){var t=e.global;return t}));this.map.eventsObServer.emit(Fp.DrawDone,this.map.mode,t),this.reset(),this.handleMaskClearMoving({reset:!0})}},{key:"handleMaskClearMoving",value:function(e){var t=e.points,r=void 0===t?[]:t,n=e.reset,i=void 0!==n&&n,o=this.map.getLayers(),a=this.map.drawingStyle,s=a.lineWidth,u=void 0===s?10:s,l=this.map.getScale(),c=u/l;So(o,(function(e){if(e.type!==Rm.Mask||i)e.type===Rm.Mask&&i&&e.setMovingClearAction(null);else{var t=new Bm("".concat(+new Date),{points:r,width:c},{},a);e.setMovingClearAction(t)}}))}},{key:"handleMapZoom",value:function(e){var t=90+this.map.zoomWheelRatio,r=e.offsetX,n=e.offsetY,i={x:r,y:n},o=this.map.transformScreenToGlobal(i),a={screen:i,global:o},s=e.deltaY<0?this.map.zoom*t/100:100*this.map.zoom/t,u=this.map.getScreenCenter(),l=this.map.transformScreenToGlobal(u,{basePoint:a,zoom:s});this.map.centerAndZoom({center:l,zoom:s},{refreshDelay:!0})}},{key:"handleFeatureSelect",value:function(e){var t=this.map.getTargetFeatureWithPoint(this.startPoint.global);t&&this.map.eventsObServer.emit(Fp.FeatureSelected,t)}},{key:"handleActiveFeatureCapture",value:function(e){var t=this,r=e.offsetX,n=e.offsetY,i={x:r,y:n},o=this.map.transformScreenToGlobal(i),a=this.map.activeFeature,s=a||{},u=s.type,l=s.shape;switch(this.hoverFeature=null,this.hoverFeatureIndex=void 0,u){case Fm.Point:a.captureWithPoint(o)&&(this.hoverFeature=a,this.setEventCursor(Bp.Pointer),this.map.eventLayer.breakFeatureCapture=!0,this.setTip({text:"按下移动图形/右键删除",position:o}));break;case Fm.Rect:case Fm.Circle:var c=u===Fm.Rect,h=c?a.getPoints():a.getEdgePoints();So(h,(function(e,r){var n=t.map.transformGlobalToScreen(e),a=Um.MathUtil.distance(n,i);if(a<=5){t.hoverFeatureIndex=r;var s=1===r||3===r?Bp.NESW_Resize:Bp.NWSE_Resize;return t.setEventCursor(s),t.map.eventLayer.breakFeatureCapture=!0,t.setTip({text:"按下拖动",position:o}),!1}})),!Hs(this.hoverFeatureIndex)&&a.captureWithPoint(o)&&(this.hoverFeature=a,this.setEventCursor(Bp.Move),this.map.eventLayer.breakFeatureCapture=!0,this.setTip({text:"按下移动图形",position:o}));break;case Fm.Line:case Fm.Polyline:case Fm.Polygon:var f=u===Fm.Line,v=u===Fm.Polyline;Fm.Polygon;var y=l,p=y.start,d=y.end,m=l,g=m.points,b=void 0===g?[]:g,w=f?[p,d]:b,x=w.length;So(w,(function(e,r){var n=t.map.transformGlobalToScreen(e),a=Um.MathUtil.distance(n,i);if(a<=5){t.hoverFeatureIndex=r,t.setEventCursor(Bp.Pointer);var s=f||v?2:3,u=x>s?"/右键删除":"";return t.map.eventLayer.breakFeatureCapture=!0,t.setTip({text:"按下拖动".concat(u),position:o}),!1}if(!f){if(v&&!w[r+1])return!1;var l=w[r+1]||w[0],c=Um.MathUtil.getMiddlePoint(e,l),h=t.map.transformGlobalToScreen(c),y=Um.MathUtil.distance(h,i);return y<=5?(t.hoverFeatureIndex=r+.5,t.setEventCursor(Bp.Pointer),t.map.eventLayer.breakFeatureCapture=!0,t.setTip({text:"按下拖动添加新节点",position:o}),!1):void 0}})),!Hs(this.hoverFeatureIndex)&&a.captureWithPoint(o)&&(this.hoverFeature=a,this.setEventCursor(Bp.Move),this.map.eventLayer.breakFeatureCapture=!0,this.setTip({text:"按下移动图形",position:o}));break}}},{key:"handleActiveFeatureStart",value:function(e){var t=this;this.map.tipLayer.removeAllFeatureActionText();var r=Um.EventUtil.getButtonIndex(e);0===r?(this.dragging=!0,document.onmousemove=function(e){return t.handleActiveFeatureMove(e)},document.onmouseup=function(e){return t.handleActiveFeatureEnd(e)}):2===r&&this.handleActiveFeatureElse(e)}},{key:"handleActiveFeatureMove",value:function(e){var t=this,r=this.getDltXY(e,{transform:!0}),n=r.x,i=r.y,o=this.getDltXY(e,{transform:!1}),a=o.x;o.y;var s=this.map.activeFeature,u=s.type,l=s.shape,c=s.style,h=this.map.xAxis.direction===Lp.Right,f=this.map.yAxis.direction===Ep.Top,v=h?n:-n,y=f?i:-i,p=h?a:-a;switch(u){case Fm.Point:var d,m=l,g=m.x,b=m.y;this.toUpdateShape=Km(Km({},l),{},{x:g+v,y:b-y}),this.map.overlayLayer.addActiveFeature(s),this.map.overlayLayer.addPointFeature(this.toUpdateShape,{clear:!1,style:Km(Km({},c),{},{fillStyle:null===(d=this.map)||void 0===d?void 0:d.editingColor})});break;case Fm.Circle:var w,x=l,k=x.cx,O=x.cy,P=x.r,S=x.sr;if(this.hoverFeature)this.toUpdateShape=Km(Km({},l),{},{cx:k+v,cy:O-y});else if(Hs(this.hoverFeatureIndex)){0===this.hoverFeatureIndex||this.hoverFeatureIndex;var D=1===this.hoverFeatureIndex||2===this.hoverFeatureIndex,j=s.getSubType(),C=j===_m.Global,A=C?D?P+v:P-v:D?S+p:S-p;if(A<=0)return void console.warn("circle update error: invalid radius, radius <= 0");this.toUpdateShape=Km(Km({},l),C?{r:A}:{sr:A})}this.map.overlayLayer.addActiveFeature(s),this.map.overlayLayer.addCircleFeature(this.toUpdateShape,{clear:!1,style:Km(Km({},c),{},{lineWidth:1,strokeStyle:null===(w=this.map)||void 0===w?void 0:w.editingColor})});break;case Fm.Rect:var M,T=l,L=T.x,E=T.y,R=T.width,I=T.height,F=null;if(this.hoverFeature)F={x:L+v,y:E-y,width:R,height:I};else if(Hs(this.hoverFeatureIndex)){var _=0===this.hoverFeatureIndex||3===this.hoverFeatureIndex,B=0===this.hoverFeatureIndex||1===this.hoverFeatureIndex,z=_?L+v:L,W=B?E-y:E,U=_?R-n:R+n,G=B?I-i:I+i,K=h?z+U:z-U,N=f?W-G:W+G,Y=h?Math.min(z,K):Math.max(z,K),X=f?Math.max(W,N):Math.min(W,N),H=Math.abs(U),$=Math.abs(G);F={x:Y,y:X,width:H,height:$}}this.toUpdateShape=Km(Km({},l),F),this.map.overlayLayer.addActiveFeature(s),this.map.overlayLayer.addRectFeature(this.toUpdateShape,{clear:!1,style:Km(Km({},c),{},{lineWidth:1,strokeStyle:null===(M=this.map)||void 0===M?void 0:M.editingColor})});break;case Fm.Line:case Fm.Polyline:case Fm.Polygon:var Z,q,V,J=u===Fm.Line,Q=u===Fm.Polyline,ee=u===Fm.Polygon,te=l,re=te.start,ne=te.end,ie=l,oe=ie.points,ae=void 0===oe?[]:oe,se=J?[re,ne]:ae,ue=[];if(this.hoverFeature)ue=cd(se,(function(e){var t=e.x,r=e.y;return{x:t+v,y:r-y}}));else if(Hs(this.hoverFeatureIndex)){var le=parseInt("".concat(this.hoverFeatureIndex),10);So(se,(function(e,r){var n=e.x,i=e.y;if(r===le&&le===t.hoverFeatureIndex)ue.push({x:n+v,y:i-y});else if(r===le&&le!==t.hoverFeatureIndex){var o=se[r+1]||se[0],a=Um.MathUtil.getMiddlePoint({x:n,y:i},o);ue.push({x:n,y:i}),ue.push({x:a.x+v,y:a.y-y})}else ue.push({x:n,y:i})}))}if(J){var ce=ue,he=Xp(ce,2),fe=he[0],ve=he[1];this.toUpdateShape=Km(Km({},l),{},{start:fe,end:ve})}else this.toUpdateShape=Km(Km({},l),{},{points:ue});this.map.overlayLayer.addActiveFeature(s),J&&this.map.overlayLayer.addLineFeature(this.toUpdateShape,{clear:!1,style:Km(Km({},c),{},{strokeStyle:null===(Z=this.map)||void 0===Z?void 0:Z.editingColor})}),Q&&this.map.overlayLayer.addPolylineFeature(this.toUpdateShape,{clear:!1,style:Km(Km({},c),{},{strokeStyle:null===(q=this.map)||void 0===q?void 0:q.editingColor})}),ee&&this.map.overlayLayer.addPolygonFeature(this.toUpdateShape,{clear:!1,style:Km(Km({},c),{},{lineWidth:1,strokeStyle:null===(V=this.map)||void 0===V?void 0:V.editingColor})});break}this.map.eventsObServer.emit(Fp.Draging,this.map.activeFeature,this.toUpdateShape)}},{key:"handleActiveFeatureEnd",value:function(e){this.dragging=!1,document.onmousemove=null,document.onmouseup=null,this.map.overlayLayer.removeAllFeatureActionText();var t=this.map.activeFeature;if(t&&this.map.overlayLayer.addActiveFeature(t),this.toUpdateShape&&t){var r=t.type;switch(r){case Fm.Point:case Fm.Circle:case Fm.Line:case Fm.Polyline:case Fm.Rect:case Fm.Polygon:this.map.eventsObServer.emit(Fp.FeatureUpdated,t,this.toUpdateShape);break}this.toUpdateShape=null}}},{key:"handleActiveFeatureElse",value:function(e){var t=this.map.activeFeature;if(t){var r=t.type,n=t.shape;switch(r){case Fm.Point:this.map.eventsObServer.emit(Fp.FeatureDeleted,t);break;case Fm.Polyline:case Fm.Polygon:var i=r===Fm.Polyline;Fm.Polygon;var o=i?2:3,a=n,s=a.points,u=void 0===s?[]:s;if(Hs(this.hoverFeatureIndex)&&u.length>o){var l=parseInt("".concat(this.hoverFeatureIndex),10);if(l===this.hoverFeatureIndex){var c=Wp(u,(function(e,t){return t!==l})),h=Km(Km({},n),{},{points:c});this.map.eventsObServer.emit(Fp.FeatureUpdated,t,h)}}break}}}},{key:"handleFeatureCapture",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.extraTip,n=void 0===r?"":r,i=this.dragging||this.tmpPointsStore.length;if(this.map.featureCaptureWhenMove&&!i){var o=this.map.getTargetFeatureWithPoint(e);o&&this.setTip({text:(n?n+"/":"")+"双击选中",position:e})}}},{key:"clearMousemoveTimer",value:function(){this.mousemoveTimer&&(window.clearTimeout(this.mousemoveTimer),this.mousemoveTimer=null)}},{key:"getMouseEventPoint",value:function(e){var t=e.offsetX,r=e.offsetY,n={x:t,y:r},i=this.map.transformScreenToGlobal(n);return{screen:n,global:i}}},{key:"onMouseDown",value:function(e){var t=e.screenX,r=e.screenY;this.startPoint=this.getMouseEventPoint(e),this.startPageScreenPoint={x:t,y:r};var n=this.map.mode,i=this.dragging,o=this.hoverFeature||Hs(this.hoverFeatureIndex),a=!i&&!o;if(this.map.eventsObServer.emit(Fp.MouseDown,this.startPoint),!this.map.activeFeature||o){var s=Um.EventUtil.getButtonIndex(e),u=o&&!i;(0===s||u)&&n!==Ip.Ban&&(n===Ip.Pan&&a?this.handleMapPanStart(e):n===Ip.MARKER&&a?this.handleMarkerStart(e):n===Ip.Point&&a?this.handlePointStart(e):n===Ip.Circle&&a?this.handleCircleStart(e):n===Ip.Line&&a?this.handleLineStart(e):n===Ip.Polyline&&a?this.handlePolylineStart(e):n===Ip.Rect&&a?this.handleRectStart(e):n===Ip.Polygon&&a?this.handlePolygonStart(e):n!==Ip.DrawMask&&n!==Ip.ClearMask||!a||this.handleMaskStart(e),u&&this.handleActiveFeatureStart(e))}else this.map.eventsObServer.emit(Fp.FeatureUnselected,this.map.activeFeature,"cancel by click")}},{key:"onMouseMove",value:function(e){this.mouseMoveEvent=e;var t=this.getMouseEventPoint(e),r=t.screen,n=t.global,i=this.map.mode,o=this.dragging;if(this.map.eventsObServer.emit(Fp.MouseMove,{screen:r,global:n}),this.map.activeFeature||o||this.map.overlayLayer.removeAllFeatureActionText(),i!==Ip.Ban){if(i!==Ip.Pan||o)if(i!==Ip.MARKER||o)if(i!==Ip.Point||o)if(i===Ip.Circle)this.setEventCursor(Bp.Crosshair,{},n),o||(this.setTip({text:"按下确定圆心",position:n}),this.handleFeatureCapture(n));else if(i!==Ip.Line||o)if(i!==Ip.Polyline||o)if(i===Ip.Rect)this.setEventCursor(Bp.Crosshair,{},n),o||(this.setTip({text:"按下确定起点",position:n}),this.handleFeatureCapture(n));else if(i!==Ip.Polygon||o){if(i===Ip.DrawMask){var a=Gs(this.map.drawingStyle,"lineWidth",1);this.setEventCursor(zp.DrawMask,{type:Fm.Circle,shape:{sr:a/2,cx:n.x,cy:n.y}})}else if(i===Ip.ClearMask){var s=Gs(this.map.drawingStyle,"lineWidth",1);this.setEventCursor(zp.ClearMask,{type:Fm.Circle,shape:{sr:s/2,cx:n.x,cy:n.y}})}}else this.setEventCursor(Bp.Crosshair,{},n),this.handlePolygonMove(e),this.handleFeatureCapture(n);else this.setEventCursor(Bp.Crosshair,{},n),this.handlePolylineMove(e),this.handleFeatureCapture(n);else this.setEventCursor(Bp.Crosshair,{},n),this.handleLineMove(e),this.handleFeatureCapture(n);else this.setEventCursor(Bp.Crosshair,{},n),this.setTip({text:"点击绘制点",position:n}),this.handleFeatureCapture(n);else this.setEventCursor(Bp.Crosshair,{},n);else this.setEventCursor(Bp.Grab);this.map.activeFeature&&!o&&this.setTip({text:"单击取消选中",position:n}),dm([Ip.Point,Ip.Circle,Ip.Line,Ip.Polyline,Ip.Rect,Ip.Polygon],i)&&!o&&this.handleActiveFeatureCapture(e)}}},{key:"onMouseUp",value:function(e){this.map.eventsObServer.emit(Fp.MouseUp,this.getMouseEventPoint(e))}},{key:"onMouseClick",value:function(e){this.map.eventsObServer.emit(Fp.Click,this.getMouseEventPoint(e))}},{key:"onMouseDblClick",value:function(e){var t=this.map.mode;this.clearDownTimer();var r=this.dragging||this.tmpPointsStore.length;this.map.eventsObServer.emit(Fp.DblClick,this.getMouseEventPoint(e)),t!==Ip.Ban&&(t===Ip.Polyline&&r?this.handlePolylineEnd(e):t===Ip.Polygon&&r&&this.handlePolygonEnd(e),dm([Ip.Point,Ip.Circle,Ip.Line,Ip.Polyline,Ip.Rect,Ip.Polygon],t)&&!r&&this.handleFeatureSelect(e))}},{key:"onMouseWheel",value:function(e){var t=this.map.mode;switch(t!==Ip.Ban&&e.preventDefault(),t){case Ip.Ban:break;case Ip.Pan:this.handleMapZoom(e);break;default:this.map.zoomWhenDrawing&&this.handleMapZoom(e);break}}},{key:"clearPanWhenDrawingTimer",value:function(){this.panWhenDrawingTimer&&(window.clearInterval(this.panWhenDrawingTimer),this.panWhenDrawingTimer=null)}},{key:"handlePanWhenDrawing",value:function(e){var t=this,r=Um.EventUtil.getMouseDirection(this.map.wrapperDom,e);this.clearPanWhenDrawingTimer();var n=10;this.map.panWhenDrawing&&this.tmpPointsStore.length&&(this.panWhenDrawingTimer=window.setInterval((function(){var e=t.map.getScale(),i=n/e,o=t.map.getCenter(),a=t.map.xAxis.direction===Lp.Right,s=t.map.yAxis.direction===Ep.Top,u=o;switch(r){case 0:u={x:o.x,y:s?o.y+i:o.y-i};break;case 1:u={x:a?o.x+i:o.x-i,y:o.y};break;case 2:u={x:o.x,y:s?o.y-i:o.y+i};break;case 3:u={x:a?o.x-i:o.x+i,y:o.y};break}t.map.setCenter(u)}),100))}},{key:"onMouseOut",value:function(e){if(e.preventDefault(),this.map.tipLayer.removeAllFeatureActionText(),this.map.supportLayer.removeAllSupports(),this.map.cursorLayer.removeAllFeatureActionText(),e.toElement){var t=e.toElement.getAttribute("data-type");if(t===zm.Marker)return}this.handlePanWhenDrawing(e),this.map.eventsObServer.emit(Fp.MouseOut,this.getMouseEventPoint(e))}},{key:"onMouseOver",value:function(e){e.preventDefault(),this.map.tipLayer.removeAllFeatureActionText(),this.clearPanWhenDrawingTimer(),this.map.eventsObServer.emit(Fp.MouseOver,this.getMouseEventPoint(e))}},{key:"revokeTmpPointsStore",value:function(){if(this.tmpPointsStore.length){this.tmpPointsStore.pop();var e=this.mouseMoveEvent;e&&this.onMouseMove(e)}}},{key:"setTip",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.map.drawingTip?this.map.tipLayer.addText(e,t):this.map.tipLayer.removeAllFeatureActionText()}},{key:"setCrosshair",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.map.drawingCrosshair?this.map.supportLayer.addCrosshair(e,t):this.map.supportLayer.removeAllSupports()}},{key:"setEventCursor",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0;this.map.setCursor(e,t),r&&this.map.drawingCrosshair?this.setCrosshair(r):this.map.supportLayer.removeAllSupports()}},{key:"reset",value:function(){this.tmpPointsStore=[],this.map.overlayLayer.removeAllFeatureActionText(),this.map.tipLayer.removeAllFeatureActionText()}},{key:"refresh",value:function(){qp($p(r.prototype),"refresh",this).call(this)}}]),r}(Om),Hm={BASE64:"base64",BLOB:"blob"},$m=function(){function e(t){n(this,e),a(this,"objects",[]),a(this,"map",{activeFeature:null,setActiveFeature:function(){},getScale:function(){return 1},transformGlobalToScreen:function(e){var t=e.x,r=e.y,n=this.bounds,i=n.x,o=n.y;return{x:t-i,y:r-o}}}),this.bounds=t,this.createRenderCanvas(),this.map.getScale=this.map.getScale.bind(this),this.map.transformGlobalToScreen=this.map.transformGlobalToScreen.bind(this)}return o(e,[{key:"createRenderCanvas",value:function(){var e=this.bounds,t=e.width,r=e.height;this.canvas=document.createElement("canvas"),this.canvas.width=t*Dm.dpr,this.canvas.height=r*Dm.dpr,this.canvas.style.width=t+"px",this.canvas.style.height=r+"px",this.canvasContext=this.canvas.getContext("2d"),Am.drawRect(this.canvasContext,{x:0,y:0,width:this.canvas.width,height:this.canvas.height},{fill:!0,fillStyle:"#fff",stroke:!1})}},{key:"addObject",value:function(e){e.onAdd(this),this.objects.push(e)}},{key:"addObjects",value:function(e){var t=this;So(e,(function(e){return t.addObject(e)}))}},{key:"putImage",value:function(e){this.canvasContext.drawImage(e,0,0)}},{key:"addImageLayer",value:function(e){var t=this.map.transformGlobalToScreen(e.position),r=t.x,n=t.y,i=Dm.dpr,o=this.map.getScale(),a=e.imageInfo,s=a.width,u=a.height,l=s*o,c=u*o;e.image&&e.imageSuccess&&Am.drawImage(this.canvasContext,{image:e.image,x:r*i,y:n*i,width:l*i,height:c*i},{})}},{key:"convertCanvasToImage",value:function(e,t,r){return e===Hm.BASE64?this.convertCanvasToBase64(t,r):e===Hm.BLOB?this.convertCanvasToBlob(t,r):new Promise((function(t,r){r(new Error("export params error："+e))}))}},{key:"convertCanvasToBlob",value:function(e,t){var r=this;return new Promise((function(n,i){r.canvas.toBlob((function(t){r.canvas=null;var o=r.bounds,a=o.width,s=o.height;r.resizeBlobImage(t,{width:a,height:s},e,n,i)}),e,t)}))}},{key:"resizeBlobImage",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"image/png",n=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0,o=new Image,a=URL.createObjectURL(e);o.src=a;var s=t.width,u=t.height,l=document.createElement("canvas"),c=l.getContext("2d");l.width=s,l.height=u,l.style.width=s+"px",l.style.height=u+"px",o.onload=function(){URL.revokeObjectURL(a),c.drawImage(o,0,0,s,u),l.toBlob((function(e){l=null,n(e)}),r,1)},o.onerror=function(){i(new Error("resize image error"))}}},{key:"convertCanvasToBase64",value:function(e,t){var r=this.canvas.toDataURL(e);this.canvas=null;var n=this.bounds,i=n.width,o=n.height;return this.resizeBase64Image(r,{width:i,height:o},e)}},{key:"resizeBase64Image",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"image/png",n=new Image;n.src=e;var i=t.width,o=t.height,a=document.createElement("canvas"),s=a.getContext("2d");return a.width=i,a.height=o,a.style.width=i+"px",a.style.height=o+"px",new Promise((function(e,t){n.onload=function(){s.drawImage(n,0,0,i,o),e(a.toDataURL(r))},n.onerror=function(){t(new Error("resize image error"))}}))}},{key:"refresh",value:function(){So(this.objects,(function(e){return e.refresh()}))}},{key:"clear",value:function(){this.canvasContext.clearRect(0,0,this.canvas.width,this.canvas.height)}}]),e}(),Zm=function(){function e(t,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};n(this,e),this.id=t,this.type=r,this.props=i,this.style=Ci({},e.defaultStyle,o)}return o(e,[{key:"onAdd",value:function(e){this.layer=e,this.refresh()}},{key:"onRemove",value:function(){var e,t,r=null===(e=this.layer)||void 0===e||null===(t=e.map)||void 0===t?void 0:t.activeFeature;r&&r.id===this.id&&this.layer.map.setActiveFeature(null)}},{key:"getBounds",value:function(){return{x:0,y:0,width:0,height:0}}},{key:"captureWithPoint",value:function(e){return!1}},{key:"updateShape",value:function(e){var t,r,n;this.shape=e,null===(t=this.layer)||void 0===t||t.refresh();var i=null===(r=this.layer)||void 0===r||null===(n=r.map)||void 0===n?void 0:n.activeFeature;i&&i.id===this.id&&this.layer.map.setActiveFeature(this)}},{key:"onMove",value:function(e){}},{key:"setStyle",value:function(e,t){var r,n=t.refresh,i=void 0===n||n;this.style=e,i&&(null===(r=this.layer)||void 0===r||r.refresh())}},{key:"refresh",value:function(){}},{key:"printInfo",value:function(){}}]),e}();function qm(e){var t=Vm();return function(){var r,n=$p(e);if(t){var i=$p(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return ed(this,r)}}function Vm(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}a(Zm,"moveStep",1),a(Zm,"defaultStyle",{opacity:1,fillStyle:"rgba(255, 0, 0, 0)",lineWidth:1,strokeStyle:"#000"});var Jm=function(e){Jp(r,e);var t=qm(r);function r(e,i){var o,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},l=arguments.length>4?arguments[4]:void 0;return n(this,r),o=t.call(this,e,Fm.Point,s,u),a(Hp(o),"option",{}),o.shape=i,o.option=Ci({},r.defaultOption,l||{}),o}return o(r,[{key:"captureWithPoint",value:function(e){var t,r,n=this.shape,i=n.x,o=n.y,a=n.r,s=n.sr,u=null===(t=this.layer)||void 0===t||null===(r=t.map)||void 0===r?void 0:r.getScale(),l=u?3/u:0,c=Hs(a)?a+l:Hs(s)?s/u+l:l;return Um.MathUtil.pointInPoint(e,{x:i,y:o},{tolerance:c})}},{key:"refresh",value:function(){var e,t=this.shape,r=t.x,n=t.y,i=t.r,o=t.sr;if(null!==(e=this.layer)&&void 0!==e&&e.map){var a=this.layer.map.transformGlobalToScreen({x:r,y:n}),s=a.x,u=a.y,l=Dm.dpr,c=this.layer.map.getScale(),h=Hs(i)?i*c:Hs(o)?o:2,f=s*l,v=u*l,y=h*l;if(Am.drawPoint(this.layer.canvasContext,{x:f,y:v,r:y},this.style,{}),this.option.active){var p=f-y-2,d=v-y-2,m=2*y+4,g=2*y+4,b=p+m,w=d,x=b,k=w+g,O=p,P=k;Am.drawLine(this.layer.canvasContext,{start:{x:p,y:d},end:{x:x,y:k}},{strokeStyle:"#fff"}),Am.drawLine(this.layer.canvasContext,{start:{x:b,y:w},end:{x:O,y:P}},{strokeStyle:"#fff"}),Am.drawRect(this.layer.canvasContext,{x:p,y:d,width:m,height:g},{strokeStyle:"#666"})}}}}]),r}(Zm);function Qm(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function eg(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Qm(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Qm(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function tg(e){var t=rg();return function(){var r,n=$p(e);if(t){var i=$p(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return ed(this,r)}}function rg(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}a(Jm,"defaultOption",{active:!1});var ng=function(e){Jp(r,e);var t=tg(r);function r(e,i){var o,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return n(this,r),o=t.call(this,e,Fm.Line,a,s),o.shape=i,o}return o(r,[{key:"captureWithPoint",value:function(e){var t,r,n=this.shape,i=n.start,o=n.end,a=n.width,s=null===(t=this.layer)||void 0===t||null===(r=t.map)||void 0===r?void 0:r.getScale(),u=s?3/s:0,l=Hs(a)?a/2+u:u;return Um.MathUtil.pointInPolyline(e,[i,o],{tolerance:l})}},{key:"getLineWidth",value:function(){var e,t,r=this.shape,n=r.width,i=this.style.lineWidth||1,o=null===(e=this.layer)||void 0===e||null===(t=e.map)||void 0===t?void 0:t.getScale();return n?n*o:i}},{key:"refresh",value:function(){var e;if(null!==(e=this.layer)&&void 0!==e&&e.map){var t=this.shape,r=t.start,n=t.end,i=t.width,o=this.layer.map.transformGlobalToScreen(r),a=o.x,s=o.y,u=this.layer.map.transformGlobalToScreen(n),l=u.x,c=u.y,h=Dm.dpr,f=this.layer.map.getScale(),v=(i||0)*f,y=this.getLineWidth(),p=Math.atan((c-s)/(l-a));p+=(l>a?90:-90)*Math.PI/180;var d=1.2*y*h,m=1.4*y*h;this.style.arrow&&Am.drawArrow(this.layer.canvasContext,{position:{x:l*h,y:c*h},points:[{x:0*h,y:0-m},{x:d,y:2*d-m},{x:-d,y:2*d-m}]},p,eg(eg({},this.style),{},{lineWidth:2},this.style.strokeStyle?{fillStyle:this.style.strokeStyle}:{})),Am.drawLine(this.layer.canvasContext,eg({start:{x:a*h,y:s*h},end:{x:l*h,y:c*h}},Hs(i)?{width:v*h}:{}),this.style,{})}}}]),r}(Zm);function ig(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function og(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ig(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ig(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ag(e){var t=sg();return function(){var r,n=$p(e);if(t){var i=$p(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return ed(this,r)}}function sg(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}var ug=function(e){Jp(r,e);var t=ag(r);function r(e,i){var o,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return n(this,r),o=t.call(this,e,Fm.Polyline,a,s),o.shape=i,o}return o(r,[{key:"captureWithPoint",value:function(e){var t,r,n=this.shape,i=n.points,o=void 0===i?[]:i,a=n.width,s=null===(t=this.layer)||void 0===t||null===(r=t.map)||void 0===r?void 0:r.getScale(),u=s?3/s:0,l=Hs(a)?a/2+u:u;return Um.MathUtil.pointInPolyline(e,o,{tolerance:l})}},{key:"refresh",value:function(){var e,t=this;if(null!==(e=this.layer)&&void 0!==e&&e.map){var r=Dm.dpr,n=this.layer.map.getScale();Am.drawPolyline(this.layer.canvasContext,this.shape,this.style,{format:function(e){var i=e.points,o=e.width;return og({points:cd(i,(function(e){var n=t.layer.map.transformGlobalToScreen(e),i=n.x,o=n.y;return{x:i*r,y:o*r}}))},Hs(o)?{width:o*n*r}:{})}})}}}]),r}(Zm);function lg(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function cg(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?lg(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):lg(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function hg(e){var t=fg();return function(){var r,n=$p(e);if(t){var i=$p(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return ed(this,r)}}function fg(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}var vg=function(e){Jp(r,e);var t=hg(r);function r(e,i){var o,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return n(this,r),o=t.call(this,e,Fm.Rect,a,s),o.shape=i,o}return o(r,[{key:"captureWithPoint",value:function(e){var t=this.getPoints();return Um.MathUtil.pointInPolygon(e,t)}},{key:"getPoints",value:function(){var e,t,r,n,i=(null===(e=this.layer)||void 0===e||null===(t=e.map)||void 0===t?void 0:t.xAxis.direction)===Lp.Left,o=(null===(r=this.layer)||void 0===r||null===(n=r.map)||void 0===n?void 0:n.yAxis.direction)===Ep.Bottom,a=this.shape,s=a.x,u=a.y,l=a.width,c=a.height,h=i?s-l:s+l,f=o?u+c:u-c;return[{x:s,y:u},{x:h,y:u},{x:h,y:f},{x:s,y:f}]}},{key:"onMove",value:function(e){var t,r,n,i,o,a,s,u,l,c,h,f=Zm.moveStep,v=this.shape,y=v.x,p=v.y,d=null===(t=this.layer)||void 0===t||null===(r=t.map)||void 0===r?void 0:r.getScale(),m=(null===(n=this.layer)||void 0===n||null===(i=n.map)||void 0===i||null===(o=i.xAxis)||void 0===o?void 0:o.direction)===Lp.Left,g=(null===(a=this.layer)||void 0===a||null===(s=a.map)||void 0===s||null===(u=s.yAxis)||void 0===u?void 0:u.direction)===Ep.Bottom,b=f/d,w={};switch(e){case Tp.UP:w={y:g?p-b:p+b};break;case Tp.DOWN:w={y:g?p+b:p-b};break;case Tp.LEFT:w={x:m?y+b:y-b};break;case Tp.RIGHT:w={x:m?y-b:y+b};break}var x=cg(cg({},this.shape),w);null===(l=this.layer)||void 0===l||null===(c=l.map)||void 0===c||null===(h=c.eventsObServer)||void 0===h||h.emit(Fp.FeatureUpdated,this,x)}},{key:"refresh",value:function(){var e,t=this;if(null!==(e=this.layer)&&void 0!==e&&e.map){var r=Dm.dpr,n=this.layer.map.getScale();Am.drawRect(this.layer.canvasContext,this.shape,this.style,{format:function(e){var i=e.x,o=e.y,a=e.width,s=e.height,u=t.layer.map.transformGlobalToScreen({x:i,y:o}),l=u.x,c=u.y,h=a*n,f=s*n;return{x:l*r,y:c*r,width:h*r,height:f*r}}})}}}]),r}(Zm);function yg(e){var t=pg();return function(){var r,n=$p(e);if(t){var i=$p(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return ed(this,r)}}function pg(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}var dg=function(e){Jp(r,e);var t=yg(r);function r(e,i){var o,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return n(this,r),o=t.call(this,e,Fm.Polygon,a,s),o.shape=i,o}return o(r,[{key:"captureWithPoint",value:function(e){var t=this.shape,r=t.points,n=void 0===r?[]:r;return Um.MathUtil.pointInPolygon(e,n)}},{key:"refresh",value:function(){var e,t=this;if(null!==(e=this.layer)&&void 0!==e&&e.map){var r=this.shape,n=r.points;r.inner;var i=Dm.dpr;Am.drawPolygon(this.layer.canvasContext,n,this.style,{format:function(e){var r=t.layer.map.transformGlobalToScreen(e),n=r.x,o=r.y;return{x:n*i,y:o*i}}})}}}]),r}(Zm);function mg(e){var t=gg();return function(){var r,n=$p(e);if(t){var i=$p(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return ed(this,r)}}function gg(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}var bg=function(e){Jp(r,e);var t=mg(r);function r(e,i){var o,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},l=arguments.length>4?arguments[4]:void 0;return n(this,r),o=t.call(this,e,Fm.Circle,s,u),a(Hp(o),"option",{}),o.shape=i,o.option=Ci({},r.defaultOption,l||{}),o}return o(r,[{key:"getSubType",value:function(){var e=this.shape,t=e.r,r=e.sr;return Hs(t)?_m.Global:Hs(r)?_m.Screen:void 0}},{key:"captureWithPoint",value:function(e){var t,r,n=this.getSubType()===_m.Global,i=this.getSubType()===_m.Screen,o=this.shape,a=o.cx,s=o.cy,u=o.r,l=o.sr,c=null===(t=this.layer)||void 0===t||null===(r=t.map)||void 0===r?void 0:r.getScale(),h=c?3/c:0,f=n?u+h:i?l/c+h:h;return Um.MathUtil.pointInPoint(e,{x:a,y:s},{tolerance:f})}},{key:"getEdgePoints",value:function(){var e,t,r,n,i=this.getSubType()===_m.Global,o=this.getSubType()===_m.Screen,a=(null===(e=this.layer)||void 0===e||null===(t=e.map)||void 0===t?void 0:t.xAxis.direction)===Lp.Left,s=(null===(r=this.layer)||void 0===r||null===(n=r.map)||void 0===n?void 0:n.yAxis.direction)===Ep.Bottom,u=this.shape,l=u.cx,c=u.cy,h=u.r,f=u.sr,v=i?h:o?f:0,y=Math.sqrt(v*v/2),p=a?-y:y,d=s?-y:y;if(i)return[{x:l-p,y:c+d},{x:l+p,y:c+d},{x:l+p,y:c-d},{x:l-p,y:c-d}];if(o){var m,g,b=null===(m=this.layer)||void 0===m||null===(g=m.map)||void 0===g?void 0:g.getScale();if(!b)return console.error("circle getEdgePoints error: no added to layer or map"),[];var w=y/b,x=a?-w:w,k=s?-w:w;return[{x:l-x,y:c+k},{x:l+x,y:c+k},{x:l+x,y:c-k},{x:l-x,y:c-k}]}return console.error("circle getEdgePoints error: no valid radius"),[]}},{key:"refresh",value:function(){var e,t=this;if(null!==(e=this.layer)&&void 0!==e&&e.map){var r=this.getSubType()===_m.Global,n=Dm.dpr,i=this.layer.map.getScale();if(Am.drawCircle(this.layer.canvasContext,this.shape,this.style,{format:function(e){var o=e.cx,a=e.cy,s=e.r,u=e.sr,l=r?s*i:Hs(u)?u:2,c=t.layer.map.transformGlobalToScreen({x:o,y:a}),h=c.x,f=c.y;return{cx:h*n,cy:f*n,r:l*n}}}),this.option.active){var o=this.getEdgePoints();So(o,(function(e){var r=e.x,i=e.y;Am.drawCircle(t.layer.canvasContext,{sr:3.5,cx:r,cy:i},{strokeStyle:"#666",fillStyle:"#fff",stroke:!0,fill:!0,lineWidth:1},{format:function(e){var r=e.cx,i=e.cy,o=e.sr,a=o,s=t.layer.map.transformGlobalToScreen({x:r,y:i}),u=s.x,l=s.y;return{cx:u*n,cy:l*n,r:a*n}}})}))}}}}]),r}(Zm);function wg(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function xg(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?wg(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):wg(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function kg(e){var t=Og();return function(){var r,n=$p(e);if(t){var i=$p(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return ed(this,r)}}function Og(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}a(bg,"defaultOption",{active:!1});var Pg,Sg=function(e){Jp(r,e);var t=kg(r);function r(e,i,o){var s,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return n(this,r),s=t.call(this,e,pm.Draw,u,l),a(Hp(s),"category",""),s.shape=o,s.category=i,s}return o(r,[{key:"refresh",value:function(){var e=this,t=Dm.dpr,r=this.layer.map.getScale(),n=xg(xg({},this.style||{}),{},{lineCap:"round",lineJoin:"round"});Am.drawPolyline(this.layer.canvasContext,this.shape,n,{format:function(n){var i=n.points,o=n.width;return xg({points:cd(i,(function(r){var n=e.layer.map.transformGlobalToScreen(r),i=n.x,o=n.y;return{x:i*t,y:o*t}}))},Hs(o)?{width:o*r*t}:{})}})}}]),r}(mm);function Dg(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function jg(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Dg(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Dg(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}(function(e){e["Text"]="TEXT"})(Pg||(Pg={}));var Cg=function(){function e(t,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};n(this,e),this.id=t,this.type=Pg.Text,this.props=i,this.textInfo=Ci({},e.defaultTextInfo,r),this.style=Ci({},e.defaultStyle,o)}return o(e,[{key:"onAdd",value:function(e){this.layer=e,this.refresh()}},{key:"onRemove",value:function(){}},{key:"updateText",value:function(e){if(Ad(e)&&e){var t,r=this.textInfo;this.textInfo=jg(jg({},r),{},{text:e}),null===(t=this.layer)||void 0===t||t.refresh()}}},{key:"updatePosition",value:function(e){var t,r=this.textInfo;this.textInfo=jg(jg({},r),{},{position:e}),null===(t=this.layer)||void 0===t||t.refresh()}},{key:"refresh",value:function(){var e,t=this;if(null!==(e=this.layer)&&void 0!==e&&e.map){var r=this.textInfo,n=Dm.dpr;Am.drawText(this.layer.canvasContext,r,this.style,{format:function(e){var r=e.position,i=e.offset,o=t.layer.map.transformGlobalToScreen(r),a=o.x,s=o.y,u=i.x,l=i.y;return jg(jg({},e),{},{position:{x:a*n,y:s*n},offset:{x:u*n,y:l*n}})}})}}},{key:"printInfo",value:function(){}}]),e}();function Ag(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Mg(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ag(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ag(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Tg(e){var t=Lg();return function(){var r,n=$p(e);if(t){var i=$p(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return ed(this,r)}}function Lg(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}a(Cg,"defaultStyle",{opacity:1,strokeStyle:"#FF0000",background:!0,fontColor:"#FFFFFF",fillStyle:"#FF0000",font:"normal 12px Arial",textAlign:"left",textBaseline:"bottom"}),a(Cg,"defaultTextInfo",{text:"",position:{x:0,y:0},offset:{x:0,y:0}});var Eg=function(e){Jp(r,e);var t=Tg(r);function r(e){var i,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return n(this,r),i=t.call(this,e,Rm.Overlay,o,s),a(Hp(i),"featureActionTexts",[]),a(Hp(i),"defaultActiveFeatureStyle",{strokeStyle:"#FF0000",fillStyle:"#FF0000",lineWidth:1}),a(Hp(i),"defaultTextStyle",{fillStyle:"#FFFFFF",strokeStyle:"#D2691E",background:!0,globalAlpha:1,fontColor:"#333",font:"normal 10px Arial",textBaseline:"top"}),i}return o(r,[{key:"addFeatureActionText",value:function(e,t){var r=t||{},n=r.clear,i=void 0!==n&&n;i&&this.removeAllFeatureActionText(),e.onAdd(this),this.featureActionTexts.push(e)}},{key:"addPointFeature",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.style,n=t.clear,i=void 0===n||n,o=t.active,a=void 0!==o&&o,s=new Jm("".concat(+new Date),e,{},r||this.map.drawingStyle,{active:a});this.addFeatureActionText(s,{clear:i})}},{key:"addLineFeature",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.style,n=t.clear,i=void 0===n||n,o=new ng("".concat(+new Date),e,{},r||this.map.drawingStyle);this.addFeatureActionText(o,{clear:i});var a=e,s=a.start,u=a.end;this.addDrawingPoints([s,u])}},{key:"addPolylineFeature",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.style,n=t.clear,i=void 0===n||n,o=new ug("".concat(+new Date),e,{},r||this.map.drawingStyle);this.addFeatureActionText(o,{clear:i}),this.addDrawingPoints(e.points)}},{key:"addRectFeature",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.style,n=t.clear,i=void 0===n||n,o=new vg("".concat(+new Date),e,{},r||this.map.drawingStyle);this.addFeatureActionText(o,{clear:i});var a=o.getPoints();this.addDrawingPoints(a)}},{key:"addPolygonFeature",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.style,n=t.clear,i=void 0===n||n,o=new dg("".concat(+new Date),e,{},r||this.map.drawingStyle);this.addFeatureActionText(o,{clear:i}),this.addDrawingPoints(e.points)}},{key:"addCircleFeature",value:function(e,t){var r=t||{},n=r.clear,i=void 0===n||n,o=r.style,a=r.active,s=void 0!==a&&a,u=new bg("".concat(+new Date),e,{},o||this.map.drawingStyle,{active:s});this.addFeatureActionText(u,{clear:i})}},{key:"addDrawAction",value:function(e){var t=new Sg("".concat(+new Date),"drawAction",e,{},this.map.drawingStyle);this.addFeatureActionText(t,{clear:!0})}},{key:"addText",value:function(e,t){var r=t||{},n=r.clear,i=void 0===n||n,o=new Cg("".concat(+new Date),Mg(Mg({},e),{},{offset:{x:5,y:-5}}),{},this.defaultTextStyle);this.addFeatureActionText(o,{clear:i})}},{key:"addActiveFeature",value:function(e){if(e){var t=this.defaultActiveFeatureStyle,r=e.type,n=e.shape;switch(r){case Fm.Point:this.addPointFeature(n,{style:t,active:!0});break;case Fm.Line:this.addLineFeature(n,{style:t});break;case Fm.Polyline:this.addPolylineFeature(n,{style:t}),this.addActiveMiddlePoints(n.points,{withClose:!1});break;case Fm.Rect:this.addRectFeature(n,{style:t});break;case Fm.Polygon:this.addPolygonFeature(n,{style:t}),this.addActiveMiddlePoints(n.points,{withClose:!0});break;case Fm.Circle:this.addCircleFeature(n,{style:t,active:!0});break}}else this.removeAllFeatureActionText()}},{key:"addActiveMiddlePoints",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.withClose,i=void 0===n||n;So(e,(function(r,n){var o=i?e[n+1]||e[0]:e[n+1];if(o){var a=Um.MathUtil.getMiddlePoint(r,o);t.addDrawingPoint(a,{strokeStyle:"#228B22",withAddIcon:!0,isMiddlePoint:!0})}}))}},{key:"addDrawingPoints",value:function(e){var t=this;So(e,(function(e){t.addDrawingPoint(e)}))}},{key:"addDrawingPoint",value:function(e){var t,r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.strokeStyle,o=void 0===i?"#666":i,a=n.fillStyle,s=void 0===a?"#fff":a,u=n.withAddIcon,l=void 0!==u&&u,c=n.iconColor,h=void 0===c?"#228B22":c,f=n.isMiddlePoint,v=void 0!==f&&f,y=e.x,p=e.y,d=null===(t=this.map)||void 0===t?void 0:t.slotsObServer[_p.DrawActivePoint];if(!v&&Xe(d)){var m=d(e,this);if(!1===m)return}var g=null===(r=this.map)||void 0===r?void 0:r.slotsObServer[_p.DrawActiveMiddlePoint];if(v&&Xe(g)){var b=g(e,this);if(!1===b)return}this.addCircleFeature({sr:3.5,cx:y,cy:p},{clear:!1,style:{strokeStyle:o,fillStyle:s,stroke:!0,fill:!0,lineWidth:1}}),l&&this.addCircleFeature({sr:1.25,cx:y,cy:p},{clear:!1,style:{fillStyle:h,stroke:!1,fill:!0}})}},{key:"removeAllFeatureActionText",value:function(){this.featureActionTexts=[],this.clear()}},{key:"refresh",value:function(){qp($p(r.prototype),"refresh",this).call(this),So(this.featureActionTexts,(function(e){return e.refresh()}))}}]),r}(Dm);function Rg(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ig(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Rg(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Rg(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Fg(e){var t=_g();return function(){var r,n=$p(e);if(t){var i=$p(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return ed(this,r)}}function _g(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}var Bg=function(e){Jp(r,e);var t=Fg(r);function r(e){var i,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return n(this,r),i=t.call(this,e,Rm.Support,o,s),a(Hp(i),"supports",[]),i}return o(r,[{key:"addSupports",value:function(e,t){var r=t||{},n=r.clear,i=void 0!==n&&n;i&&this.removeAllSupports(),e.onAdd(this),this.supports.push(e)}},{key:"addText",value:function(e,t){var n=t||{},i=n.style,o=n.clear,a=void 0===o||o,s=new Cg("".concat(+new Date),Ig(Ig({},e),{},{offset:{x:5,y:-5}}),{},i||r.defaultTextStyle);this.addSupports(s,{clear:a})}},{key:"addLineFeature",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.style,i=t.clear,o=void 0===i||i,a=new ng("".concat(+new Date),e,{},n||r.defaultFeatureStyle);this.addSupports(a,{clear:o})}},{key:"addCrosshair",value:function(e){var t=e.x,r=e.y,n=this.map.getBounds(),i=n.x,o=n.y,a=n.width,s=n.height,u={x:i,y:r},l={x:i+a,y:r},c={x:t,y:o},h={x:t,y:o-s};this.addLineFeature({start:u,end:l},{clear:!0}),this.addLineFeature({start:c,end:h},{clear:!1})}},{key:"removeAllSupports",value:function(){this.supports=[],this.clear()}},{key:"refresh",value:function(){qp($p(r.prototype),"refresh",this).call(this),So(this.supports,(function(e){return e.refresh()}))}}]),r}(Dm);a(Bg,"defaultTextStyle",{fillStyle:"#FFFFFF",strokeStyle:"#D2691E",background:!0,globalAlpha:1,fontColor:"#333",font:"normal 10px Arial",textBaseline:"top"}),a(Bg,"defaultFeatureStyle",{fillStyle:"#FFFFFF",strokeStyle:"#D2691E",background:!0,globalAlpha:.3,fontColor:"#333",font:"normal 10px Arial",textBaseline:"top"});var zg=Sp,Wg=kr,Ug=gi;function Gg(e){return function(t,r,n){var i=Object(t);if(!Wg(t)){var o=zg(r);t=Ug(t),r=function(e){return o(i[e],e,i)}}var a=e(t,r,n);return a>-1?i[o?t[a]:a]:void 0}}var Kg=Gg,Ng=yd,Yg=Sp,Xg=em,Hg=Math.max;function $g(e,t,r){var n=null==e?0:e.length;if(!n)return-1;var i=null==r?0:Xg(r);return i<0&&(i=Hg(n+i,0)),Ng(e,Yg(t),i)}var Zg=$g,qg=Kg,Vg=Zg,Jg=qg(Vg),Qg=Jg;function eb(e){var t=tb();return function(){var r,n=$p(e);if(t){var i=$p(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return ed(this,r)}}function tb(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}var rb=function(e){Jp(r,e);var t=eb(r);function r(e){var i,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return n(this,r),i=t.call(this,e,Rm.Marker,o,s),a(Hp(i),"markers",[]),i}return o(r,[{key:"addMarker",value:function(e,t){e.onAdd(this),this.markers.push(e)}},{key:"removeMarkerById",value:function(e){var t=Wp(this.markers,(function(t){var r=t.id;return r!==e||(t.onRemove(),!1)}));this.markers=t,this.refresh()}},{key:"getMarkerById",value:function(e){return Qg(this.markers,(function(t){var r=t.id;return r===e}))}},{key:"getAllMarkers",value:function(){return this.markers}},{key:"removeAllMarkers",value:function(){var e=Wp(this.markers,(function(e){return e.onRemove(),!1}));this.markers=e,this.refresh()}},{key:"resize",value:function(){this.dom.style.width="0px",this.dom.style.height="0px"}},{key:"refresh",value:function(){qp($p(r.prototype),"refresh",this).call(this),So(this.markers,(function(e){return e.refresh()}))}}]),r}(Om),nb=function(){function e(t,r){var i=this;n(this,e),a(this,"controls",[]),a(this,"layers",[]),a(this,"drawingStyle",{}),a(this,"drawingTip",!0),a(this,"drawingCrosshair",!0),a(this,"editingColor","#FF0000"),a(this,"slotsObServer",{}),a(this,"activeFeature",null),a(this,"events",{on:function(e,t){i.eventsObServer.on(e,t)}}),a(this,"slots",{on:function(e,t){i.slotsObServer[e]=t}}),this.wrapperDomId=t,this.wrapperDom=document.getElementById(t),this.createMainDom(),this.mapOptions=Ci({},e.defaultMapOptions,r),this.zoom=this.mapOptions.zoom,this.center=this.mapOptions.center,this.mode=this.mapOptions.mode,this.refreshDelayWhenZooming=this.mapOptions.refreshDelayWhenZooming,this.zoomWhenDrawing=this.mapOptions.zoomWhenDrawing,this.panWhenDrawing=this.mapOptions.panWhenDrawing,this.featureCaptureWhenMove=this.mapOptions.featureCaptureWhenMove,this.withHotKeys=this.mapOptions.withHotKeys,this.zoomWheelRatio=this.mapOptions.zoomWheelRatio,this.xAxis=this.mapOptions.xAxis,this.yAxis=this.mapOptions.yAxis,this.size=this.mapOptions.size||{width:Gs(this.dom,"clientWidth",0),height:Gs(this.dom,"clientHeight",0)},this.setDomStyle(),this.createSubDoms(),this.addOverlayLayer(),this.addTipLayer(),this.addSupportLayer(),this.addCursorLayer(),this.addEventLayer(),this.addMarkerLayer(),this.eventsObServer=new T.EventEmitter,this.withHotKeys&&this.registerHotkey()}return o(e,[{key:"setDomStyle",value:function(){this.dom.ondragstart=function(e){e.preventDefault(),e.stopPropagation()},this.dom.oncontextmenu=function(e){e.preventDefault(),e.stopPropagation()}}},{key:"setMode",value:function(e){this.mode=e,this.eventLayer.reset(),this.activeFeature&&this.eventsObServer.emit(Fp.FeatureUnselected,this.activeFeature,"cancel by switch mode")}},{key:"setDrawingStyle",value:function(e){this.drawingStyle=e}},{key:"setEditingColor",value:function(e){this.editingColor=e}},{key:"enableDrawingTip",value:function(){this.drawingTip=!0}},{key:"disableDrawingTip",value:function(){this.drawingTip=!1}},{key:"enableDrawingCrosshair",value:function(){this.drawingCrosshair=!0}},{key:"disableDrawingCrosshair",value:function(){this.drawingCrosshair=!1}},{key:"getSize",value:function(){return this.size}},{key:"getScale",value:function(e){var t=Hs(e)?e:this.zoom,r=1e6,n=this.getSize(),i=n.width,o=parseInt(i*r/t+"",10)/r;return o}},{key:"setCenter",value:function(e){return this.center=e,this.refresh(),this.triggerBoundsChanged(),this}},{key:"getCenter",value:function(){return this.center}},{key:"getScreenCenter",value:function(){var e=this.getSize(),t=e.width,r=e.height;return{x:t/2,y:r/2}}},{key:"getBounds",value:function(e){var t=this.getSize(),r=t.width,n=t.height,i=this.transformScreenToGlobal({x:0,y:0}),o=i.x,a=i.y,s=this.transformScreenToGlobal({x:r,y:n}),u=s.x,l=s.y;return{x:o,y:a,width:u-o,height:a-l}}},{key:"enableZoomWhenDrawing",value:function(){this.zoomWhenDrawing=!0}},{key:"disableZoomWhenDrawing",value:function(){this.zoomWhenDrawing=!1}},{key:"enablePanWhenDrawing",value:function(){this.panWhenDrawing=!0}},{key:"disablePanWhenDrawing",value:function(){this.panWhenDrawing=!1}},{key:"enableFeatureCaptureWhenMove",value:function(){this.featureCaptureWhenMove=!0}},{key:"disableFeatureCaptureWhenMove",value:function(){this.featureCaptureWhenMove=!1}},{key:"enableHotKeys",value:function(){this.withHotKeys||(this.withHotKeys=!0,this.registerHotkey())}},{key:"disableHotKeys",value:function(){this.withHotKeys&&(this.withHotKeys=!1,this.unbindHotkey())}},{key:"centerAndZoom",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.refreshDelay,n=void 0!==r&&r,i=e.center,o=e.zoom;return i&&(this.center=i),Hs(o)&&(this.zoom=o),this.refresh(n&&this.refreshDelayWhenZooming),this.triggerBoundsChanged(),this}},{key:"zoomTo",value:function(e){this.zoom=e,this.refresh(),this.triggerBoundsChanged()}},{key:"zoomIn",value:function(){this.zoom=this.zoom/2,this.refresh(),this.triggerBoundsChanged()}},{key:"zoomOut",value:function(){this.zoom=2*this.zoom,this.refresh(),this.triggerBoundsChanged()}},{key:"setZoomWheelRatio",value:function(e){this.zoomWheelRatio=e}},{key:"addControl",value:function(e){e.onAdd(this),this.controls.push(e)}},{key:"removeControlById",value:function(e){var t=Wp(this.controls,(function(t){var r=t.id;return r!==e||(t.onRemove(),!1)}));this.controls=t}},{key:"addLayer",value:function(e){var t=e.dom;this.layerDom.appendChild(t),e.onAdd(this),this.layers.push(e)}},{key:"removeLayerById",value:function(e){var t=Wp(this.layers,(function(t){var r=t.id;return r!==e||(t.onRemove(),!1)}));this.layers=t,this.refresh()}},{key:"removeAllLayers",value:function(){var e=Wp(this.layers,(function(e){return e.onRemove(),!1}));this.layers=e,this.refresh()}},{key:"getLayers",value:function(){return this.layers}},{key:"triggerBoundsChanged",value:function(){var e=this;this.boundsChangedTimer&&(window.clearTimeout(this.boundsChangedTimer),this.boundsChangedTimer=null),this.boundsChangedTimer=window.setTimeout((function(){e.eventsObServer.emit(Fp.BoundsChanged)}),666),this.overlayLayer.refresh()}},{key:"refresh",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];So(this.layers,(function(t){return t.refresh(e)})),this.markerLayer.refresh()}},{key:"resize",value:function(e){this.size=e||{width:Gs(this.dom,"clientWidth",0),height:Gs(this.dom,"clientHeight",0)},this.setLayerDomSize(),this.setPlatformDomSize(),So(this.layers,(function(e){return e.resizeAndRefresh()})),this.markerLayer.resizeAndRefresh(),this.overlayLayer.resizeAndRefresh(),this.tipLayer.resizeAndRefresh(),this.cursorLayer.resizeAndRefresh(),this.supportLayer.resizeAndRefresh(),this.eventLayer.resizeAndRefresh()}},{key:"setActiveFeature",value:function(e){this.activeFeature=e,this.overlayLayer.addActiveFeature(e);var t=this.eventLayer.mouseMoveEvent;t&&this.eventLayer.onMouseMove(t)}},{key:"getActiveFeature",value:function(){return this.activeFeature}},{key:"removeDrawingPoints",value:function(){this.eventLayer.revokeTmpPointsStore()}},{key:"getTargetFeatureWithPoint",value:function(e){var t=this.getLayers(),r=[];So(t,(function(t){if(t.type===Rm.Feature){var n=t.getTargetFeatureWithPoint(e);if(n)return r.push(n),!1}}));var n=Gs(r,"[0]",null);return n}},{key:"exportLayersToImage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.layers,i=void 0===n?this.getLayers():n,o=t.type,a=void 0===o?"base64":o,s=t.format,u=void 0===s?"image/png":s,l=t.quality,h=void 0===l?1:l,f=i,v=new $m(e),y=[];return So(f,function(){var t=r(c.mark((function t(r){var n,i,o,a,s,u;return c.wrap((function(t){while(1)switch(t.prev=t.next){case 0:r.type===Rm.Feature?(n=r.getAllFeatures(),i=Hf(n),v.addObjects(i),y.push(new Promise((function(e){e(!0)})))):r.type===Rm.Text?(o=r.getAllTexts(),a=Hf(o),v.addObjects(a),y.push(new Promise((function(e){e(!0)})))):r.type===Rm.Mask?(s=r.getImageWithBounds(e),y.push(new Promise((function(e,t){var r=new Image;r.onload=function(){v.putImage(r),e(!0)},r.onerror=function(){t()},r.src=s})))):r.type===Rm.Image&&(u=Hf(r),v.addImageLayer(u),y.push(new Promise((function(e){e(!0)}))));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),new Promise((function(e,t){Promise.all(y).then((function(){var t=v.convertCanvasToImage(a,u,h);t.then((function(t){v=null,e(t)}))["catch"]((function(e){console.log(e)}))}))["catch"]((function(e){console.log(e)}))}))}},{key:"transformScreenToGlobal",value:function(e,t){var r=t||{},n=r.basePoint,i=r.zoom,o=this.getScale(i),a=this.getScreenCenter(),s=a.x,u=a.y,l=e.x,c=e.y,h=Gs(n,"screen.x",s),f=Gs(n,"screen.y",u),v=Gs(n,"global",this.center),y=v.x,p=v.y,d=l-h,m=c-f,g=this.xAxis.direction===Lp.Right,b=this.yAxis.direction===Ep.Top,w=g?y+d/o:y-d/o,x=b?p-m/o:p+m/o;return{x:w,y:x}}},{key:"transformGlobalToScreen",value:function(e,t){var r=t||{},n=r.basePoint,i=r.zoom,o=this.getScale(i),a=this.getScreenCenter(),s=a.x,u=a.y,l=e.x,c=e.y,h=Gs(n,"screen.x",s),f=Gs(n,"screen.y",u),v=Gs(n,"global",this.center),y=v.x,p=v.y,d=l-y,m=c-p,g=this.xAxis.direction===Lp.Right,b=this.yAxis.direction===Ep.Top,w=g?h+d*o:h-d*o,x=b?f-m*o:f+m*o;return{x:w,y:x}}},{key:"createMainDom",value:function(){this.domId="main-wrapper-".concat(Vi()),this.dom=document.createElement("div"),this.dom.setAttribute("id",this.domId),this.dom.style.position="absolute",this.dom.style.left="0",this.dom.style.top="0",this.dom.style.right="0",this.dom.style.bottom="0",this.wrapperDom.appendChild(this.dom)}},{key:"createSubDoms",value:function(){this.setLayerDom(),this.setPlatformDom(),this.setLayerDom2(),this.setControlDom()}},{key:"setLayerDom",value:function(){this.layerDomId="layer-wrapper-".concat(Vi()),this.layerDom=document.createElement("div"),this.layerDom.setAttribute("id",this.layerDomId),this.layerDom.style.position="absolute",this.layerDom.style.left="0",this.layerDom.style.top="0",this.layerDom.style.zIndex="1",this.setLayerDomSize(),this.dom.appendChild(this.layerDom)}},{key:"setLayerDomSize",value:function(){var e=this.getSize(),t=e.width,r=e.height;this.layerDom.style.width="".concat(t,"px"),this.layerDom.style.height="".concat(r,"px")}},{key:"setPlatformDom",value:function(){this.platformDomId="platform-wrapper-".concat(Vi()),this.platformDom=document.createElement("div"),this.platformDom.setAttribute("id",this.platformDomId),this.platformDom.style.position="absolute",this.platformDom.style.left="0",this.platformDom.style.top="0",this.platformDom.style.zIndex="5",this.setPlatformDomSize(),this.dom.appendChild(this.platformDom)}},{key:"setPlatformDomSize",value:function(){var e=this.getSize(),t=e.width,r=e.height;this.platformDom.style.width="".concat(t,"px"),this.platformDom.style.height="".concat(r,"px")}},{key:"setLayerDom2",value:function(){this.layerDom2Id="layer2-wrapper-".concat(Vi()),this.layerDom2=document.createElement("div"),this.layerDom2.setAttribute("id",this.layerDom2Id),this.layerDom2.style.position="absolute",this.layerDom2.style.left="0",this.layerDom2.style.right="0",this.layerDom2.style.width="0",this.layerDom2.style.height="0",this.layerDom2.style.zIndex="10",this.dom.appendChild(this.layerDom2)}},{key:"setControlDom",value:function(){this.controlDomId="control-wrapper-".concat(Vi()),this.controlDom=document.createElement("div"),this.controlDom.setAttribute("id",this.controlDomId),this.controlDom.style.position="absolute",this.controlDom.style.left="0",this.controlDom.style.right="0",this.controlDom.style.width="0",this.controlDom.style.height="0",this.controlDom.style.zIndex="15",this.dom.appendChild(this.controlDom)}},{key:"addEventLayer",value:function(){this.eventLayer=new Xm("event-".concat(Vi()),{},{zIndex:5}),this.platformDom.appendChild(this.eventLayer.dom),this.eventLayer.onAdd(this)}},{key:"addOverlayLayer",value:function(){this.overlayLayer=new Eg("overlay-".concat(Vi()),{},{zIndex:1}),this.platformDom.appendChild(this.overlayLayer.dom),this.overlayLayer.onAdd(this)}},{key:"addTipLayer",value:function(){this.tipLayer=new Eg("tip-".concat(Vi()),{},{zIndex:2}),this.platformDom.appendChild(this.tipLayer.dom),this.tipLayer.onAdd(this)}},{key:"addSupportLayer",value:function(){this.supportLayer=new Bg("support-".concat(Vi()),{},{zIndex:1}),this.platformDom.appendChild(this.supportLayer.dom),this.supportLayer.onAdd(this)}},{key:"addCursorLayer",value:function(){this.cursorLayer=new Eg("cursor-".concat(Vi()),{},{zIndex:3}),this.platformDom.appendChild(this.cursorLayer.dom),this.cursorLayer.onAdd(this)}},{key:"addMarkerLayer",value:function(){this.markerLayer=new rb("marker-".concat(Vi()),{},{zIndex:10}),this.layerDom2.appendChild(this.markerLayer.dom),this.markerLayer.onAdd(this)}},{key:"registerHotkey",value:function(){var e=this;oe("ctrl+z",(function(t,r){e.removeDrawingPoints()})),oe("up,down,left,right",(function(t,r){t.preventDefault(),t.stopPropagation();var n=e.getActiveFeature();n&&n.onMove(r.key)}))}},{key:"unbindHotkey",value:function(){oe.unbind("ctrl+z"),oe.unbind("up,down,left,right")}},{key:"setCursor",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.cursorLayer.removeAllFeatureActionText(),this.platformDom.style.cursor=e,this.setCursorFeature(t),this}},{key:"setUrlCursor",value:function(e){return this}},{key:"setCursorFeature",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.type,r=e.shape;t===Fm.Circle&&this.cursorLayer.addCircleFeature(r,{style:{lineWidth:1,strokeStyle:"#aaa",fillStyle:"#ffffffb3",stroke:!0,fill:!0}})}},{key:"onDrag",value:function(e,t){this.layerDom.style.left="".concat(e,"px"),this.layerDom.style.top="".concat(t,"px"),this.layerDom2.style.left="".concat(e,"px"),this.layerDom2.style.top="".concat(t,"px")}},{key:"onZoom",value:function(e){this.dom.style.transform="scale(".concat(e,")")}},{key:"reset",value:function(){return this.layerDom.style.left="0",this.layerDom.style.top="0",this.layerDom2.style.left="0",this.layerDom2.style.top="0",this}},{key:"destroy",value:function(){this.dom.remove()}},{key:"printInfo",value:function(){}}]),e}();function ib(e){var t=ob();return function(){var r,n=$p(e);if(t){var i=$p(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return ed(this,r)}}function ob(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}a(nb,"defaultMapOptions",{center:{x:0,y:0},zoom:1e3,zoomWheelRatio:5,mode:Ip.Pan,size:null,refreshDelayWhenZooming:!0,zoomWhenDrawing:!1,featureCaptureWhenMove:!1,withHotKeys:!0,panWhenDrawing:!1,xAxis:{direction:Lp.Right},yAxis:{direction:Ep.Bottom}});var ab=function(e){Jp(r,e);var t=ib(r);function r(e,i){var o,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return n(this,r),o=t.call(this,e,Rm.Image,s,u),a(Hp(o),"imageSuccess",!1),a(Hp(o),"events",{on:function(e,t){o.eventsObServer.on(e,t)}}),o.eventsObServer=new T.EventEmitter,o.imageInfo=Ci({},r.defaultImageInfo,i),o.position=o.imageInfo.position,o.grid=o.imageInfo.grid,o}return o(r,[{key:"updateImageInfo",value:function(e){this.imageInfo=Ci({},this.imageInfo,e),e.position&&(this.position=this.imageInfo.position),e.src&&this.updateImage(),this.refresh()}},{key:"updateImage",value:function(){var e=this;this.imageInfo.src&&(this.imageSuccess=!1,this.eventsObServer.emit(Im.LoadStart,this.imageInfo.src,this),this.image=new Image,this.imageInfo.crossOrigin?this.image.setAttribute("crossOrigin","anonymous"):this.image.removeAttribute("crossOrigin"),this.image.src=this.imageInfo.src,this.image.onload=function(){e.imageSuccess=!0,e.map&&e.refresh(),e.eventsObServer.emit(Im.LoadEnd,e.imageInfo.src,e)},this.image.onerror=function(){e.imageSuccess=!1,console.error("image src: "+e.imageInfo.src+" load error"),e.eventsObServer.emit(Im.LoadError,e.imageInfo.src,e)})}},{key:"updateGrid",value:function(e){this.grid=e,this.refresh()}},{key:"onAdd",value:function(e){qp($p(r.prototype),"onAdd",this).call(this,e),this.updateImage(),this.refresh()}},{key:"drawImage",value:function(){var e=this.map.transformGlobalToScreen(this.position),t=e.x,r=e.y,n=Dm.dpr,i=this.map.getScale(),o=this.imageInfo,a=o.width,s=o.height,u=a*i,l=s*i;this.image&&this.imageSuccess&&Am.drawImage(this.canvasContext,{image:this.image,x:t*n,y:r*n,width:u*n,height:l*n},{})}},{key:"drawGrid",value:function(){var e=this,t=this.imageInfo,r=t.width,n=t.height,i=this.position,o=i.x,a=i.y,s=Dm.dpr,u=this.map.xAxis.direction===Lp.Right,l=this.map.yAxis.direction===Ep.Top,c=Gs(this.grid,"columns",[]),h=Gs(this.grid,"rows",[]),f=c.length,v=r/(f+1);So(c,(function(t,r){var i=t||{},c=i.color,h=void 0===c?"#333":c,f=i.width,y=void 0===f?1:f,p=(r+1)*v,d=u?o+p:o-p,m=a,g=l?a-n:a+n,b=e.map.transformGlobalToScreen({x:d,y:m}),w=e.map.transformGlobalToScreen({x:d,y:g});Am.drawLine(e.canvasContext,{start:{x:b.x*s,y:b.y*s},end:{x:w.x*s,y:w.y*s}},{strokeStyle:h,lineWidth:y})}));var y=h.length,p=n/(y+1);So(h,(function(t,n){var i=t||{},c=i.color,h=void 0===c?"#333":c,f=i.width,v=void 0===f?1:f,y=(n+1)*p,d=l?a-y:a+y,m=o,g=u?o+r:o-r,b=e.map.transformGlobalToScreen({x:m,y:d}),w=e.map.transformGlobalToScreen({x:g,y:d});Am.drawLine(e.canvasContext,{start:{x:b.x*s,y:b.y*s},end:{x:w.x*s,y:w.y*s}},{strokeStyle:h,lineWidth:v})}))}},{key:"refresh",value:function(){qp($p(r.prototype),"refresh",this).call(this),this.drawImage(),this.drawGrid()}}]),r}(Dm);function sb(e){var t=ub();return function(){var r,n=$p(e);if(t){var i=$p(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return ed(this,r)}}function ub(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}a(ab,"defaultImageInfo",{src:"",width:0,height:0,position:{x:0,y:0},crossOrigin:!1,grid:{columns:[],rows:[]}});var lb=function(e){Jp(r,e);var t=sb(r);function r(e){var i,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return n(this,r),i=t.call(this,e,Rm.Feature,o,s),a(Hp(i),"features",[]),i}return o(r,[{key:"addFeature",value:function(e,t){var r=t||{},n=r.clear,i=void 0!==n&&n;i&&(this.features=[],this.clear()),e.onAdd(this),this.features.push(e)}},{key:"removeFeatureById",value:function(e){var t=Wp(this.features,(function(t){var r=t.id;return r!==e||(t.onRemove(),!1)}));this.features=t,this.refresh()}},{key:"getFeatureById",value:function(e){return Qg(this.features,(function(t){var r=t.id;return r===e}))}},{key:"getAllFeatures",value:function(){return this.features}},{key:"removeAllFeatures",value:function(){var e=Wp(this.features,(function(e){return e.onRemove(),!1}));this.features=e,this.refresh()}},{key:"getTargetFeatureWithPoint",value:function(e){var t=[];return So(this.features,(function(r){var n=r.captureWithPoint(e);if(n)return t.push(r),!1})),Gs(t,"[0]",null)}},{key:"refresh",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.refreshDelayTimer&&(window.clearTimeout(this.refreshDelayTimer),this.refreshDelayTimer=null),qp($p(r.prototype),"refresh",this).call(this),t?this.refreshDelayTimer=window.setTimeout((function(){So(e.features,(function(e){return e.refresh()}))}),100):So(this.features,(function(e){return e.refresh()}))}}]),r}(Dm),cb=Od;function hb(e,t){var r=null==e?0:e.length;return!!r&&cb(e,t,0)>-1}var fb=hb;function vb(e,t,r){var n=-1,i=null==e?0:e.length;while(++n<i)if(r(t,e[n]))return!0;return!1}var yb=vb;function pb(){}var db=pb,mb=Nl,gb=db,bb=xv,wb=1/0,xb=mb&&1/bb(new mb([,-0]))[1]==wb?function(e){return new mb(e)}:gb,kb=xb,Ob=av,Pb=fb,Sb=yb,Db=cv,jb=kb,Cb=xv,Ab=200;function Mb(e,t,r){var n=-1,i=Pb,o=e.length,a=!0,s=[],u=s;if(r)a=!1,i=Sb;else if(o>=Ab){var l=t?null:jb(e);if(l)return Cb(l);a=!1,i=Db,u=new Ob}else u=t?[]:s;e:while(++n<o){var c=e[n],h=t?t(c):c;if(c=r||0!==c?c:0,a&&h===h){var f=u.length;while(f--)if(u[f]===h)continue e;t&&u.push(h),s.push(c)}else i(u,h,r)||(u!==s&&u.push(h),s.push(c))}return s}var Tb=Mb,Lb=Tb;function Eb(e){return e&&e.length?Lb(e):[]}var Rb=Eb,Ib=function(){function e(t){n(this,e),a(this,"actions",[]),a(this,"map",{getScale:function(){return 1},transformGlobalToScreen:function(e){var t=e.x,r=e.y,n=this.bounds,i=n.x,o=n.y;return{x:t-i,y:r-o}}}),this.bounds=t,this.createRenderCanvas(),this.map.getScale=this.map.getScale.bind(this),this.map.transformGlobalToScreen=this.map.transformGlobalToScreen.bind(this)}return o(e,[{key:"createRenderCanvas",value:function(){var e=this.bounds,t=e.width,r=e.height;this.canvas=new OffscreenCanvas(t,r),this.canvas.width=t*Dm.dpr,this.canvas.height=r*Dm.dpr,this.canvasContext=this.canvas.getContext("2d")}},{key:"addAction",value:function(e){e.setStyle({strokeStyle:"#ff0000",fillStyle:"#ff0000"},{refresh:!1}),e.onAdd(this),this.actions.push(e)}},{key:"addActions",value:function(e){var t=this;So(e,(function(e){return t.addAction(e)}))}},{key:"getRle",value:function(){for(var e=[],t=Dm.dpr,r=this.bounds,n=r.width,i=r.height,o=this.canvas,a=o.width,s=o.height,u=this.canvasContext.getImageData(0,0,a,s).data,l=0,c=1,h=0;h<i;h++)for(var f=0;f<n;f++){var v=4*(h*t*n+f)*t,y=u[v],p=u[v+1],d=u[v+2],m=u[v+3],g=+!!(y||p||d||m);g===c?l++:(e.push(l),l=1),h+1===i&&f+1===n&&e.push(l),c=g}return e}},{key:"refresh",value:function(){So(this.actions,(function(e){return e.refresh()}))}},{key:"clear",value:function(){this.canvasContext.clearRect(0,0,this.canvas.width,this.canvas.height)}}]),e}();function Fb(e){var t=_b();return function(){var r,n=$p(e);if(t){var i=$p(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return ed(this,r)}}function _b(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}var Bb=function(e){Jp(r,e);var t=Fb(r);function r(e){var i,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return n(this,r),i=t.call(this,e,Rm.Mask,o,s),a(Hp(i),"actions",[]),i}return o(r,[{key:"addAction",value:function(e,t){e.onAdd(this),this.actions.push(e)}},{key:"removeActionById",value:function(e){var t=Wp(this.actions,(function(t){var r=t.id;return r!==e||(t.onRemove(),!1)}));this.actions=t,this.refresh()}},{key:"getAllActions",value:function(){return this.actions}},{key:"removeAllActions",value:function(){var e=Wp(this.actions,(function(e){return e.onRemove(),!1}));this.actions=e,this.refresh()}},{key:"setMovingClearAction",value:function(e){e&&e.onAdd(this),!e&&this.refresh()}},{key:"getActionCategories",value:function(){var e=this.actions,t=cd(e,(function(e){var t=e.category;return t}));return Wp(Rb(t),(function(e){return!!e}))}},{key:"groupByCategory",value:function(){var e=this.actions,t=this.getActionCategories(),r=[];return So(t,(function(t){var n=Wp(e,(function(e){var r=e.type,n=e.category;return n===t||r===pm.Clear}));r.push({category:t,actions:n})})),r}},{key:"getGroupRleData",value:function(e,t){var r=e.category,n=e.actions,i=void 0===n?[]:n,o=new Ib(t),a=Hf(i);o.addActions(a);var s=o.getRle();return{category:r,rle:s}}},{key:"getImageData",value:function(e){var t=e.x,r=e.y,n=e.width,i=e.height,o=this.map.transformGlobalToScreen({x:t,y:r}),a=this.map.getScale(),s=o.x*Dm.dpr,u=o.y*Dm.dpr,l=n/a*Dm.dpr,c=i/a*Dm.dpr,h=this.canvasContext.getImageData(s,u,l,c);return h}},{key:"getImageWithBounds",value:function(e){var t=e.width,r=e.height,n=this.getImageData(e),i=document.createElement("canvas");i.width=t*Dm.dpr,i.height=r*Dm.dpr,i.style.width=t+"px",i.style.height=r+"px";var o=i.getContext("2d");o.putImageData(n,0,0);var a=i.toDataURL("image/png",1);return a}},{key:"getRleData",value:function(e){var t=this,r=this.groupByCategory(),n=[];return So(r,(function(r){var i=t.getGroupRleData(r,e);n.push(i)})),n}},{key:"refresh",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.refreshDelayTimer&&(window.clearTimeout(this.refreshDelayTimer),this.refreshDelayTimer=null),qp($p(r.prototype),"refresh",this).call(this),t?this.refreshDelayTimer=window.setTimeout((function(){So(e.actions,(function(e){return e.refresh()}))}),100):So(this.actions,(function(e){return e.refresh()}))}}]),r}(Dm);function zb(e){var t=Wb();return function(){var r,n=$p(e);if(t){var i=$p(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return ed(this,r)}}function Wb(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}var Ub=function(e){Jp(r,e);var t=zb(r);function r(e){var i,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return n(this,r),i=t.call(this,e,Rm.Text,o,s),a(Hp(i),"texts",[]),i}return o(r,[{key:"addText",value:function(e,t){var r=t||{},n=r.clear,i=void 0!==n&&n;i&&this.clear(),e.onAdd(this),this.texts.push(e)}},{key:"removeTextById",value:function(e){var t=Wp(this.texts,(function(t){var r=t.id;return r!==e||(t.onRemove(),!1)}));this.texts=t,this.refresh()}},{key:"getTextById",value:function(e){return Qg(this.texts,(function(t){var r=t.id;return r===e}))}},{key:"getAllTexts",value:function(){return this.texts}},{key:"removeAllTexts",value:function(){var e=Wp(this.texts,(function(e){return e.onRemove(),!1}));this.texts=e,this.refresh()}},{key:"refresh",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.refreshDelayTimer&&(window.clearTimeout(this.refreshDelayTimer),this.refreshDelayTimer=null),qp($p(r.prototype),"refresh",this).call(this),t?this.refreshDelayTimer=window.setTimeout((function(){So(e.texts,(function(e){return e.refresh()}))}),100):So(this.texts,(function(e){return e.refresh()}))}}]),r}(Dm),Gb={Text:Ub,Mask:Bb,Image:ab,Feature:lb,OverlayLayer:Eg,SupportLayer:Bg,EventLayer:Xm};function Kb(e){var t=Nb();return function(){var r,n=$p(e);if(t){var i=$p(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return ed(this,r)}}function Nb(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}var Yb=function(e){Jp(r,e);var t=Kb(r);function r(e,i){var o,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return n(this,r),o=t.call(this,e,Fm.Arrow,a,s),o.shape=i,o}return o(r,[{key:"captureWithPoint",value:function(e){return!1}},{key:"refresh",value:function(){var e;null!==(e=this.layer)&&void 0!==e&&e.map}}]),r}(Zm),Xb={Base:Zm,Point:Jm,Circle:bg,Line:ng,Polyline:ug,Rect:vg,Polygon:dg,Arrow:Yb};function Hb(e){var t=$b();return function(){var r,n=$p(e);if(t){var i=$p(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return ed(this,r)}}function $b(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}var Zb=function(e){Jp(r,e);var t=Hb(r);function r(e,i,o){var s,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return n(this,r),s=t.call(this,e,pm.Image,u,l),a(Hp(s),"category",""),s.imageInfo=Ci({},r.defaultImageInfo,o),s.position=s.imageInfo.position,s.updateImage(),s.category=i,s}return o(r,[{key:"updateImage",value:function(){var e=this;this.imageInfo.src&&(this.image=new Image,this.imageInfo.crossOrigin?this.image.setAttribute("crossOrigin","anonymous"):this.image.removeAttribute("crossOrigin"),this.image.src=this.imageInfo.src,this.image.onload=function(){return e.layer&&e.refresh()})}},{key:"drawImage",value:function(){var e;if(null!==(e=this.layer)&&void 0!==e&&e.map){var t=this.layer.map.transformGlobalToScreen(this.position),r=t.x,n=t.y,i=Dm.dpr,o=this.layer.map.getScale(),a=this.imageInfo,s=a.width,u=a.height,l=s*o,c=u*o;Am.drawImage(this.layer.canvasContext,{image:this.image,x:r*i,y:n*i,width:l*i,height:c*i},{})}}},{key:"refresh",value:function(){qp($p(r.prototype),"refresh",this).call(this),this.drawImage()}}]),r}(mm);a(Zb,"defaultImageInfo",{src:"",width:0,height:0,crossOrigin:!1,position:{x:0,y:0}});var qb={Draw:Sg,Clear:Bm,Image:Zb},Vb=function(){function e(t,r,i,o){n(this,e),this.id=t,this.type=r,this.props=i||{},this.option=o||{},this.domId="control-grid-".concat(t,"-wrapper"),this.createContainer()}return o(e,[{key:"createContainer",value:function(){this.dom||(this.dom=document.createElement("div"),this.dom.setAttribute("id",this.domId),this.dom.style.position="absolute",this.dom.style.left="0",this.dom.style.top="0",this.dom.style.zIndex="20")}},{key:"onAdd",value:function(e){this.map=e,this.map.dom.appendChild(this.dom)}},{key:"onRemove",value:function(){var e=document.getElementById(this.domId);e&&e.remove()}},{key:"updatePosition",value:function(e){this.position=e,this.refresh()}},{key:"refresh",value:function(){}},{key:"printInfo",value:function(){}}]),e}();function Jb(e){var t=Qb();return function(){var r,n=$p(e);if(t){var i=$p(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return ed(this,r)}}function Qb(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}var ew,tw=function(e){Jp(r,e);var t=Jb(r);function r(){return n(this,r),t.call(this)}return o(r,[{key:"refresh",value:function(){}}]),r}(Vb);function rw(e){var t=nw();return function(){var r,n=$p(e);if(t){var i=$p(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return ed(this,r)}}function nw(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(function(e){e["Scale"]="SCALE",e["Grid"]="GRID"})(ew||(ew={}));var iw=function(e){Jp(r,e);var t=rw(r);function r(e,i,o,a){var s;return n(this,r),console.log(111,e),s=t.call(this,e,ew.Grid,o,a),s.gridInfo=Ci({},r.defaultGridInfo,i),s.creatCanvasElement(),s.refreshElement(),s}return o(r,[{key:"refreshElement",value:function(){this.setContainerSize(),this.setContainerPosition(),this.setContainerStyle(),this.setRenderCanvasSize()}},{key:"setContainerSize",value:function(){var e=this.gridInfo.size,t=e.width,r=e.height;this.dom.style.width=t+"px",this.dom.style.height=r+"px"}},{key:"setContainerPosition",value:function(){var e=this.gridInfo.position,t=e.left,r=e.top,n=e.right,i=e.bottom;this.dom.style.left=Hs(t)?"".concat(t,"px"):"initial",this.dom.style.right=Hs(n)?"".concat(n,"px"):"initial",this.dom.style.top=Hs(r)?"".concat(r,"px"):"initial",this.dom.style.bottom=Hs(i)?"".concat(i,"px"):"initial"}},{key:"setContainerStyle",value:function(){this.dom.style.border="1px solid red"}},{key:"creatCanvasElement",value:function(){this.canvas=document.createElement("canvas"),this.canvas.style.position="absolute",this.canvas.style.left="0",this.canvas.style.top="0",this.dom.appendChild(this.canvas),this.canvasContext=this.canvas.getContext("2d")}},{key:"setRenderCanvasSize",value:function(){var e=this.gridInfo.size,t=e.width,r=e.height;this.canvas.width=t*Dm.dpr,this.canvas.height=r*Dm.dpr,this.canvas.style.width=t+"px",this.canvas.style.height=r+"px"}},{key:"refresh",value:function(){}}]),r}(Vb);a(iw,"defaultGridInfo",{position:{right:10,bottom:10},size:{width:200,height:200},grid:{columns:[],rows:[]}});var ow={Scale:tw,Grid:iw};function aw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function sw(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?aw(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):aw(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var uw=function(){function e(t,r){var i=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};n(this,e),a(this,"dragging",!1),a(this,"draggingEnabled",!1),a(this,"events",{on:function(e,t){i.eventsObServer.on(e,t)}}),this.id=t,this.type=zm.Marker,this.props=o,this.markerInfo=Ci({},e.defaultMarkerInfo,r),this.updateImage(),this.eventsObServer=new T.EventEmitter}return o(e,[{key:"onAdd",value:function(e){this.layer=e,this.refresh()}},{key:"onRemove",value:function(){var e=document.getElementById(this.id);e&&e.remove()}},{key:"enableDragging",value:function(){this.draggingEnabled=!0,this.dragging=!1}},{key:"disableDragging",value:function(){this.draggingEnabled=!1,this.dragging=!1}},{key:"updateImage",value:function(){var e=this;this.markerInfo.src&&(this.image=new Image,this.image.id=this.id,this.image.setAttribute("data-type",this.type),this.image.style.position="absolute",this.image.style.cursor="pointer",this.image.style.userSelect="none",this.image.src=this.markerInfo.src,this.image.onload=function(){var t,r;null===(t=e.layer)||void 0===t||null===(r=t.dom)||void 0===r||r.appendChild(e.image),e.attachEvents()},this.image.onerror=function(){console.error("marker‘s src onerror")})}},{key:"updatePosition",value:function(e){var t=this.markerInfo;this.markerInfo=sw(sw({},t),{},{position:e}),this.refresh()}},{key:"handleMouseDown",value:function(e){var t=this,r=e.screenX,n=e.screenY;this.startPageScreenPoint={x:r,y:n},this.toUpdatePosition=null;var i=Um.EventUtil.getButtonIndex(e);this.eventsObServer.emit(Wm.MouseDown,this),2===i&&this.eventsObServer.emit(Wm.RightClick,this),this.draggingEnabled&&(this.dragging=!0,document.onmousemove=function(e){return t.handleMarkerMove(e)},document.onmouseup=function(e){return t.handleMarkerUp(e)},this.eventsObServer.emit(Wm.DragStart,this))}},{key:"handleMarkerMove",value:function(e){var t=this.layer.map.getScale(),r=e.screenX,n=e.screenY,i=this.startPageScreenPoint,o=i.x,a=i.y,s=r-o,u=n-a,l=s/t,c=u/t,h=this.layer.map.xAxis.direction===Lp.Right,f=this.layer.map.yAxis.direction===Ep.Top,v=h?l:-l,y=f?c:-c,p=this.markerInfo.position;this.toUpdatePosition={x:p.x+v,y:p.y-y},this.refresh(this.toUpdatePosition),this.eventsObServer.emit(Wm.Dragging,this,this.toUpdatePosition)}},{key:"handleMarkerUp",value:function(e){this.dragging=!1,document.onmousemove=null,document.onmouseup=null,this.toUpdatePosition&&(this.refresh(),this.eventsObServer.emit(Wm.DragEnd,this,this.toUpdatePosition)),this.toUpdatePosition=null}},{key:"handleMouseUp",value:function(e){this.eventsObServer.emit(Wm.MouseUp,this)}},{key:"handleMouseOver",value:function(e){var t,r;this.layer.map.eventLayer.breakFeatureCapture=!0,null===(t=this.layer)||void 0===t||null===(r=t.map)||void 0===r||r.tipLayer.removeAllFeatureActionText(),this.eventsObServer.emit(Wm.MouseOver,this)}},{key:"handleMouseOut",value:function(e){this.eventsObServer.emit(Wm.MouseOut,this)}},{key:"handleClick",value:function(e){this.eventsObServer.emit(Wm.Click,this)}},{key:"attachEvents",value:function(){var e=this;this.image.onmousedown=function(t){return e.handleMouseDown(t)},this.image.onmouseup=function(t){return e.handleMouseUp(t)},this.image.onmouseover=function(t){return e.handleMouseOver(t)},this.image.onmouseout=function(t){return e.handleMouseOut(t)},this.image.onclick=function(t){return e.handleClick(t)}}},{key:"refresh",value:function(e){var t=this.markerInfo,r=t.position,n=t.offset,i=e||r,o=this.layer.map.transformGlobalToScreen(i),a=o.x,s=o.y,u=n.x,l=n.y,c=a+u,h=s-l;this.image.style.left="".concat(c,"px"),this.image.style.top="".concat(h,"px")}},{key:"printInfo",value:function(){}}]),e}();a(uw,"defaultMarkerInfo",{src:"",position:{x:0,y:0},offset:{x:0,y:0}});var lw="ailabel",cw="5.1.15",hw="图像标注",fw="dist/index.js",vw="dist/index.js",yw="demo/index.js",pw="website/src/dist/index.js",dw={"@babel/runtime":"^7.15.4",events:"^3.3.0","hotkeys-js":"^3.8.7",lodash:"^4.17.21"},mw={"@babel/core":"^7.14.6","@babel/plugin-transform-runtime":"^7.15.0","@babel/preset-env":"^7.14.7","@babel/preset-typescript":"^7.14.5","@rollup/plugin-commonjs":"^19.0.1","@rollup/plugin-json":"^4.1.0","@rollup/plugin-node-resolve":"^13.0.2",rollup:"^2.53.2","rollup-plugin-babel":"^4.4.0","rollup-plugin-uglify":"^6.0.4"},gw={build:"rollup -c",dev:"rollup -c -w",pretest:"npm run build"},bw=["dist"],ww={type:"git",url:"git+https://github.com/dingyang9642/AILabel.git"},xw=["ailabel","ocr","ai","label","annotation"],kw="dingyang",Ow="Apache-2.0",Pw={url:"https://github.com/dingyang9642/AILabel/issues"},Sw="https://github.com/dingyang9642/AILabel#readme",Dw={name:lw,version:cw,description:hw,main:fw,browser:vw,browser_demo:yw,browser_website:pw,dependencies:dw,devDependencies:mw,scripts:gw,files:bw,repository:ww,keywords:xw,author:kw,license:Ow,bugs:Pw,homepage:Sw},jw="".concat(Dw.version),Cw={Map:nb,Layer:Gb,Feature:Xb,Mask:qb,Control:ow,Text:Cg,Marker:uw,Util:Um,Graphic:Am,version:jw};return Cw}))}).call(this,r("a282"))},"428f":function(e,t,r){"use strict";var n=r("4241"),i=r("a280"),o=r("c46c");n({target:"Array",proto:!0},{fill:i}),o("fill")},a280:function(e,t,r){"use strict";var n=r("aea3"),i=r("a72a"),o=r("220d");e.exports=function(e){var t=n(this),r=o(t),a=arguments.length,s=i(a>1?arguments[1]:void 0,r),u=a>2?arguments[2]:void 0,l=void 0===u?r:i(u,r);while(l>s)t[s++]=e;return t}}}]);